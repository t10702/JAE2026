<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>308 è‹±é›„æˆ°åŠ›åˆ†æç³»çµ± V5.8</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --bg: #0f172a; --card: #1e293b; --accent: #22d3ee; --gold: #fbbf24; --up: #4ade80; --down: #f87171; --xp: #8b5cf6; }
        body { background: var(--bg); color: #f8fafc; font-family: -apple-system, "Microsoft JhengHei", "å¾®è»Ÿæ­£é»‘é«”", sans-serif; margin: 0; display: flex; justify-content: center; min-height: 100vh; }
        .container { width: 95%; max-width: 600px; padding: 20px; }
        
        .login-box { background: var(--card); padding: 40px 20px; border-radius: 28px; text-align: center; border: 1px solid rgba(255,255,255,0.1); }
        select, input { width: 100%; padding: 15px; margin: 10px 0; border-radius: 12px; border: 2px solid #334155; background: #0f172a; color: white; box-sizing: border-box; font-size: 1rem; }
        .main-btn { width: 100%; padding: 18px; background: linear-gradient(135deg, #0ea5e9, #22d3ee); border: none; border-radius: 12px; color: #0f172a; font-size: 1.1rem; font-weight: 800; cursor: pointer; }
        
        #reportSection { display: none; background: var(--card); border-radius: 28px; overflow: hidden; animation: fadeIn 0.6s ease; margin-bottom: 30px; border: 1px solid rgba(255,255,255,0.1); }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .header { background: #1e293b; padding: 25px; text-align: center; border-bottom: 4px solid var(--accent); }
        .score-display { display: grid; grid-template-columns: 1fr 1fr; background: #0f172a; padding: 15px; text-align: center; }
        .score-box b { display: block; font-size: 1.6rem; color: var(--gold); }

        .progress-container { background: #0f172a; padding: 0 25px 20px; }
        .progress-label { display: flex; justify-content: space-between; font-size: 0.75rem; color: #94a3b8; margin-bottom: 5px; }
        .progress-bar-bg { background: #334155; height: 10px; border-radius: 5px; overflow: hidden; }
        .progress-bar-fill { background: linear-gradient(90deg, var(--accent), var(--xp)); height: 100%; width: 0%; transition: width 1s ease; }

        .content { padding: 20px; }
        .chart-container { height: 230px; margin-bottom: 20px; }
        
        .bar-row { margin-bottom: 12px; }
        .bar-info { display: flex; justify-content: space-between; font-size: 0.8rem; margin-bottom: 4px; color: #cbd5e1; }
        .bar-bg { background: #0f172a; height: 6px; border-radius: 3px; overflow: hidden; }
        .bar-fill { height: 100%; border-radius: 3px; transition: width 0.8s ease; }

        .time-panel { background: rgba(0,0,0,0.3); padding: 15px; border-radius: 15px; margin: 20px 0; border: 1px solid rgba(34, 211, 238, 0.3); }
        .time-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; font-size: 0.9rem; }
        .time-value { color: var(--accent); font-weight: bold; font-size: 1.1rem; }

        .schedule-table { width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 0.75rem; background: #0f172a; border-radius: 10px; overflow: hidden; }
        .schedule-table th { background: #334155; color: var(--accent); padding: 8px; }
        .schedule-table td { border: 1px solid rgba(255,255,255,0.05); padding: 10px 5px; text-align: center; }
        .sub-tag { display: block; padding: 2px 4px; border-radius: 4px; margin-bottom: 3px; font-weight: bold; }

        .strategy-item { padding: 12px; background: rgba(255,255,255,0.03); border-left: 3px solid var(--accent); margin-bottom: 10px; font-size: 0.85rem; line-height: 1.5; color: #cbd5e1; }
        .quote-box { text-align: center; padding: 30px 20px; color: var(--accent); font-style: italic; border-top: 1px solid rgba(255,255,255,0.05); margin-top: 20px; font-weight: bold; font-size: 1.1rem; }
        .reset-btn { width: 100%; padding: 12px; background: #475569; border: none; border-radius: 12px; color: white; margin-top: 10px; cursor: pointer; }
    </style>
</head>
<body>

<div class="container">
    <div id="loginWrapper" class="login-box">
        <div style="font-size: 50px;">ğŸ›¡ï¸</div>
        <h1>308 è‹±é›„æˆ°åŠ›ç³»çµ±</h1>
        <p style="color:#94a3b8; font-size: 0.8rem;">V5.8 (9åˆ†ç²¾ç®—åˆ¶)</p>
        <select id="userSelect"><option value="">-- è«‹é¸æ“‡è‹±é›„ --</option></select>
        <input type="password" id="userPass" placeholder="è¼¸å…¥å¯†ç¢¼ (é è¨­ 308+åº§è™Ÿ)">
        <button class="main-btn" onclick="handleLogin()">è§£é–æˆ°åŠ›æ•¸æ“š</button>
    </div>

    <div id="reportSection">
        <div class="header">
            <h2 id="displayName" style="margin:0">--</h2>
            <div id="predictSchool" style="color:var(--accent); font-size:0.9rem; margin-top:5px; font-weight:bold">--</div>
        </div>

        <div class="score-display">
            <div class="score-box"><small>æœƒè€ƒç¸½ç©åˆ†</small><b id="displayScore">--</b></div>
            <div class="score-box"><small>è€ƒå€åæ¬¡</small><b id="dRankDisplay" style="font-size:1.2rem; margin-top:8px">--</b></div>
        </div>

        <div class="progress-container">
            <div class="progress-label"><span id="progStart">è‹±é›„èµ·é»</span><span id="progEnd">ä¸‹ä¸€éšï¼š--</span></div>
            <div class="progress-bar-bg"><div id="progFill" class="progress-bar-fill"></div></div>
            <div id="progDetail" style="text-align: right; font-size: 0.7rem; color: var(--gold); margin-top: 5px;">è·é›¢é€²åŒ–é‚„å·® -- é»</div>
        </div>

        <div class="content">
            <div class="chart-container"><canvas id="radarChart"></canvas></div>
            
            <div id="subBars" style="margin-bottom: 30px;"></div>

            <div class="time-panel">
                <h4 style="margin:0 0 15px; color:var(--gold)">â³ æ¯æ—¥ä¿®ç…‰æ™‚é–“ (23:00 å°±å¯¢)</h4>
                <div class="time-row">
                    <span>å¹³æ—¥æ”¾å­¸è£œç¿’æ™‚é–“ï¼š</span>
                    <select id="cramTime" style="width:100px; padding:5px; margin:0" onchange="recalculateTime()">
                        <option value="0">ç„¡è£œç¿’</option><option value="2">2 å°æ™‚</option>
                        <option value="3" selected>3 å°æ™‚</option><option value="4">4 å°æ™‚</option>
                    </select>
                </div>
                <div class="time-row">
                    <span>æ¯æ—¥è‡ªä¸»ä¿®ç…‰é¤˜è£•ï¼š</span>
                    <span id="selfStudyMins" class="time-value">-- åˆ†é˜</span>
                </div>
                <div id="subTimeDist" style="font-size:0.8rem; color:#94a3b8; display:grid; grid-template-columns:1fr 1fr; gap:5px; margin-top:10px"></div>
            </div>

            <h3 style="color:var(--accent); font-size:1rem">ğŸ“… è‹±é›„é€±ä¿®ç…‰æ™‚é–“è¡¨</h3>
            <table class="schedule-table">
                <thead><tr><th>ä¸€</th><th>äºŒ</th><th>ä¸‰</th><th>å››</th><th>äº”</th><th>å…­</th><th>æ—¥</th></tr></thead>
                <tbody id="scheduleBody"></tbody>
            </table>

            <div class="input-panel" style="background: rgba(0,0,0,0.2); padding: 20px; border-radius: 20px; border: 1px dashed var(--accent); margin-top: 25px;">
                <h3 style="margin-top:0; color:var(--gold); font-size:0.9rem">ğŸ”® æˆç¸¾é€²åŒ–æ¨¡æ“¬ (9åˆ†åˆ¶)</h3>
                <div id="simInputs" style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px;"></div>
                <input type="number" id="inNewDRank" placeholder="è¼¸å…¥æœ€æ–°è€ƒå€åæ¬¡">
                <button class="main-btn" style="margin-top:10px; background:var(--xp); color:white" onclick="updateEvolution()">åŸ·è¡Œé€²åŒ–åˆ†æ</button>
                <button class="reset-btn" onclick="resetToBaseline()">ğŸ”„ å¾©åŸ 11 æœˆåŸºæº–</button>
            </div>

            <div id="evoReport" style="display:none; background:#0f172a; border-radius:15px; padding:15px; margin-top:20px; border-left:4px solid var(--gold);">
                <h4 style="margin:0 0 10px; color:var(--gold); font-size:0.9rem">ğŸ“ˆ é€²é€€æ­¥å ±å‘Š</h4>
                <div id="evoList"></div>
            </div>

            <div class="quote-box"><span id="quoteText">ã€Œ--ã€</span></div>

            <button onclick="location.reload()" style="width:100%; margin-top:30px; background:none; border:none; color:#475569; cursor:pointer;">ç™»å‡ºç³»çµ±</button>
        </div>
    </div>
</div>

<script>
    const db = [
        { id: 1, name: "ç‹æ˜±å¡", write: 4, g: {ch:"B+", en:"B", ma:"B++", sc:"B++", so:"A"}, d: 2065 },
        { id: 2, name: "å³å½¥å‹³", write: 3, g: {ch:"B+", en:"B", ma:"A", sc:"B+", so:"B"}, d: 3006 },
        { id: 3, name: "æè‡´è«­", write: 3, g: {ch:"B", en:"C", ma:"A", sc:"B", so:"B+"}, d: 3751 },
        { id: 4, name: "ææ™‰å®‰", write: 3, g: {ch:"B", en:"C", ma:"B+", sc:"B", so:"B"}, d: 5065 },
        { id: 5, name: "æ²ˆå®å½¥", write: 4, g: {ch:"A+", en:"B", ma:"A+", sc:"B+", so:"A"}, d: 1250 },
        { id: 6, name: "å¼µäºå®—", write: 0, g: {ch:"C", en:"B", ma:"B+", sc:"B", so:"B"}, d: 5326 },
        { id: 7, name: "æ¢æ¾„ç¥", write: 2, g: {ch:"B", en:"C", ma:"C", sc:"B", so:"B"}, d: 6423 },
        { id: 8, name: "é™³å®¥äºˆ", write: 3, g: {ch:"C", en:"C", ma:"C", sc:"C", so:"C"}, d: 7712 },
        { id: 9, name: "é™³ç¥å‘ˆ", write: 4, g: {ch:"A+", en:"A+", ma:"B++", sc:"B++", so:"B++"}, d: 757 },
        { id: 10, name: "é™³ç¿å®", write: 3, g: {ch:"B", en:"B", ma:"B", sc:"B+", so:"B+"}, d: 3800 },
        { id: 11, name: "æ•ç…’å‡±", write: 3, g: {ch:"B++", en:"B", ma:"B+", sc:"B+", so:"B"}, d: 2988 },
        { id: 12, name: "é»ƒå³»å”¯", write: 4, g: {ch:"A++", en:"B+", ma:"A", sc:"A", so:"A+"}, d: 468 },
        { id: 13, name: "æ¥Šçš“å®‡", write: 1, g: {ch:"B", en:"B", ma:"B+", sc:"B", so:"B++"}, d: 3865 },
        { id: 14, name: "åŠ‰ä¸æ©", write: 1, g: {ch:"B", en:"C", ma:"B", sc:"C", so:"B"}, d: 6492 },
        { id: 15, name: "åŠ‰å®¥æ‰¿", write: 4, g: {ch:"B++", en:"B++", ma:"A", sc:"B++", so:"B++"}, d: 1325 },
        { id: 16, name: "åŠ‰ç…¥é¨°", write: 4, g: {ch:"A++", en:"B++", ma:"A", sc:"A+", so:"A++"}, d: 232 },
        { id: 17, name: "æ´ªæ¹˜èŠ¸", write: 5, g: {ch:"B++", en:"B+", ma:"C", sc:"B+", so:"A+"}, d: 2191 },
        { id: 18, name: "èƒ¡èªå½¤", write: 2, g: {ch:"B", en:"B+", ma:"B++", sc:"B", so:"B"}, d: 3117 },
        { id: 19, name: "å¼µæ™ç¿", write: 3, g: {ch:"B+", en:"B", ma:"B", sc:"B", so:"B+"}, d: 3352 },
        { id: 20, name: "å¼µå‡±è–°", write: 4, g: {ch:"B", en:"B+", ma:"A", sc:"C", so:"B"}, d: 3981 },
        { id: 21, name: "è¨±æ™¶è", write: 3, g: {ch:"B+", en:"C", ma:"B+", sc:"B++", so:"B+"}, d: 3372 },
        { id: 22, name: "èŒ¹ç­±è", write: 5, g: {ch:"A+", en:"B+", ma:"B++", sc:"A+", so:"A++"}, d: 357 },
        { id: 23, name: "èŒ¹å¿ƒæ¸", write: 4, g: {ch:"B++", en:"B+", ma:"A++", sc:"B++", so:"B++"}, d: 1126 },
        { id: 24, name: "ç«¥è‹¥ç‘„", write: 4, g: {ch:"A+", en:"B++", ma:"A", sc:"A", so:"A++"}, d: 393 },
        { id: 25, name: "é»ƒç´«è¡", write: 3, g: {ch:"C", en:"C", ma:"C", sc:"C", so:"C"}, d: 7712 },
        { id: 26, name: "è©¹æ²›ç’‡", write: 5, g: {ch:"B", en:"B+", ma:"B+", sc:"B", so:"B"}, d: 3502 },
        { id: 27, name: "å»–å©•æ¸", write: 4, g: {ch:"B", en:"B", ma:"B", sc:"B", so:"B"}, d: 4886 },
        { id: 28, name: "åŠ‰èŠ®ç‘œ", write: 4, g: {ch:"A++", en:"B++", ma:"A", sc:"A", so:"A"}, d: 363 },
        { id: 29, name: "æ½˜æ›‰éš", write: 4, g: {ch:"A+", en:"A", ma:"B++", sc:"A", so:"B++"}, d: 908 },
        { id: 30, name: "è¬æ²›ç’‡", write: 5, g: {ch:"A++", en:"A+", ma:"A", sc:"A++", so:"A++"}, d: 99 }
    ];

    // æ–°ç©åˆ†åœ°åœ–ï¼šA++=9, A+=8, A=7, B++=6, B+=5, B=4, C=1
    const pointMap = {"A++":9,"A+":8,"A":7,"B++":6,"B+":5,"B":4,"C":1};
    const subName = {ch:"åœ‹æ–‡", en:"è‹±æ–‡", ma:"æ•¸å­¸", sc:"è‡ªç„¶", so:"ç¤¾æœƒ"};
    const weights = {"A++":1, "A+":1, "A":2, "B++":4, "B+":6, "B":8, "C":12};
    const quotes = ["å“è¶Šä¸æ˜¯è¡Œç‚ºï¼Œè€Œæ˜¯ä¸€ç¨®ç¿’æ…£ã€‚", "æˆåŠŸçš„é—œéµåœ¨æ–¼ï¼Œç•¶åˆ¥äººæ”¾æ£„æ™‚ä½ ä»å …æŒã€‚", "åƒé‡Œä¹‹è¡Œï¼Œå§‹æ–¼è¶³ä¸‹ã€‚", "ä¸è¦ç­‰å¾…æ©Ÿæœƒï¼Œè€Œè¦å‰µé€ æ©Ÿæœƒã€‚", "å‡¡æ˜¯ä½ æƒ³åšåˆ°çš„ï¼Œåªè¦å …æŒåˆ°åº•ï¼Œå¿…èƒ½æˆåŠŸã€‚", "ç”Ÿå‘½ä¸­æœ€è‰±é›£çš„éšæ®µä¸æ˜¯æ²’äººæ‡‚ä½ ï¼Œè€Œæ˜¯ä½ ä¸æ‡‚ä½ è‡ªå·±ã€‚"];

    let currentUser = null;
    let currentG = null;

    function handleLogin() {
        const id = document.getElementById('userSelect').value;
        const pass = document.getElementById('userPass').value;
        const defaultPwd = "308" + (id < 10 ? '0' + id : id);
        const storedPwd = localStorage.getItem('userPwd_' + id);
        if(pass === (storedPwd || defaultPwd)) {
            currentUser = db.find(x => x.id == id);
            document.getElementById('loginWrapper').style.display='none';
            initDashboard();
        } else alert("å¯†ç¢¼éŒ¯èª¤ï¼");
    }

    function initDashboard() {
        document.getElementById('reportSection').style.display = 'block';
        document.getElementById('displayName').innerText = currentUser.name;
        resetToBaseline();
    }

    function resetToBaseline() {
        currentG = JSON.parse(JSON.stringify(currentUser.g));
        ["Ch","En","Ma","Sc","So"].forEach(k => document.getElementById('in'+k).value = currentG[k.toLowerCase()]);
        document.getElementById('inWrite').value = currentUser.write;
        document.getElementById('inNewDRank').value = currentUser.d;
        recalculateTime();
    }

    function recalculateTime() {
        const cramHours = parseInt(document.getElementById('cramTime').value);
        let selfStudyMins = Math.max(0, 300 - (cramHours * 60));
        selfStudyMins = Math.min(240, selfStudyMins); // 1. è¨­å®šä¸Šé™ 240
        document.getElementById('selfStudyMins').innerText = selfStudyMins + " åˆ†é˜";
        renderAll(currentG, document.getElementById('inWrite').value, selfStudyMins);
    }

    function renderAll(g, w, studyMins) {
        // æœƒè€ƒç©åˆ† = 5ç§‘(9/8/7/6/5/4/1) + å¯«ä½œç´šåˆ†(0-6)
        const total = Object.values(g).reduce((sum, lv) => sum + pointMap[lv], 0) + parseInt(w);
        document.getElementById('displayScore').innerText = total + " pt";
        document.getElementById('dRankDisplay').innerText = document.getElementById('inNewDRank').value;
        
        updatePredict(total);
        updateProgress(total);
        renderChart(g);
        renderSubBars(g); // 3. è£œä¸Šåˆ†å¸ƒæ¢
        distributeMins(g, studyMins);
        generateSchedule(g);
        updateQuote();
    }

    function renderSubBars(g) {
        const container = document.getElementById('subBars');
        container.innerHTML = "";
        const levels = ["C", "B", "B+", "B++", "A", "A+", "A++"];
        Object.entries(g).forEach(([sub, lv]) => {
            const idx = levels.indexOf(lv);
            const percent = ((idx + 1) / levels.length) * 100;
            const color = idx >= 4 ? 'var(--up)' : (idx >= 1 ? 'var(--accent)' : 'var(--down)');
            container.innerHTML += `
                <div class="bar-row">
                    <div class="bar-info"><span>${subName[sub]}</span><span>${lv}</span></div>
                    <div class="bar-bg"><div class="bar-fill" style="width:${percent}%; background:${color}"></div></div>
                </div>`;
        });
    }

    function updateProgress(p) {
        // å› æ‡‰ 9 åˆ†åˆ¶ï¼Œèª¿æ•´é€²åº¦é–€æª»
        const steps = [
            { pt: 0, label: "è‹±é›„èµ·é»" },
            { pt: 25, label: "å½°å•†(ç¶œ) / æºªæ¹–é«˜ä¸­" },
            { pt: 32, label: "å½°å¸«é™„å·¥ / å½°å•†(è·)" },
            { pt: 38, label: "åœ‹ç«‹å½°ä¸­ / å½°å¥³" },
            { pt: 45, label: "é ‚å°–ç‰¹å„ª (ç©©é€²å½°ä¸­å¥³)" },
            { pt: 51, label: "è‹±é›„å·…å³°" }
        ];
        let next = steps.find(s => s.pt > p) || steps[steps.length-1];
        let prev = [...steps].reverse().find(s => s.pt <= p) || steps[0];
        document.getElementById('progStart').innerText = prev.label;
        document.getElementById('progEnd').innerText = "ä¸‹ä¸€éšï¼š" + next.label;
        let percent = next.pt === prev.pt ? 100 : ((p - prev.pt) / (next.pt - prev.pt)) * 100;
        document.getElementById('progFill').style.width = Math.min(100, percent) + "%";
        document.getElementById('progDetail').innerText = (next.pt - p) > 0 ? `è·é›¢é€²åŒ–é‚„å·® ${next.pt - p} é»` : "æ‚¨å·²åˆ°é”æœ€é«˜ç›®æ¨™ï¼";
    }

    function updatePredict(p) {
        let s = "éœ€åŠªåŠ›çªç ´";
        if(p >= 45) s = "é ‚å°–ç‰¹å„ª (å½°ä¸­/å½°å¥³ç©©)";
        else if(p >= 38) s = "åœ‹ç«‹å½°ä¸­ / å½°åŒ–å¥³ä¸­";
        else if(p >= 32) s = "å½°å¸«é™„å·¥ / å½°åŒ–é«˜å•†";
        else if(p >= 25) s = "æºªæ¹–é«˜ä¸­ / å½°å•†(ç¶œ)";
        document.getElementById('predictSchool').innerText = "é ä¼°è½é»ï¼š" + s;
    }

    function distributeMins(g, totalMins) {
        const container = document.getElementById('subTimeDist'); container.innerHTML = "";
        if(totalMins <= 0) { container.innerHTML = "<div style='grid-column:1/3'>ä»Šæ—¥å„ªå…ˆä¼‘æ¯ã€‚</div>"; return; }
        let totalWeight = 0;
        Object.values(g).forEach(lv => totalWeight += weights[lv]);
        Object.entries(g).forEach(([sub, lv]) => {
            const mins = Math.round((weights[lv] / totalWeight) * totalMins);
            container.innerHTML += `<div>${subName[sub]}: <span style="color:white">${mins} åˆ†</span></div>`;
        });
    }

    function generateSchedule(g) {
        const body = document.getElementById('scheduleBody'); body.innerHTML = "";
        const row = document.createElement('tr');
        const sorted = Object.entries(g).sort((a,b) => weights[b[1]] - weights[a[1]]);
        const plan = [[sorted[0][0], sorted[2][0]], [sorted[1][0], sorted[3][0]], [sorted[0][0], "å¯«ä½œ"], [sorted[1][0], sorted[4][0]], [sorted[0][0], sorted[1][0]], [sorted[2][0], sorted[3][0]], ["éŒ¯é¡Œ", "è€ƒæ¨¡"]];
        plan.forEach(day => {
            const td = document.createElement('td');
            day.forEach(s => {
                const label = subName[s] || s;
                const color = s === sorted[0][0] || s === sorted[1][0] ? 'var(--down)' : (s.includes("éŒ¯é¡Œ") ? 'var(--gold)' : 'var(--up)');
                td.innerHTML += `<span class="sub-tag" style="background:${color}; color:#000">${label}</span>`;
            });
            row.appendChild(td);
        });
        body.appendChild(row);
    }

    function updateQuote() {
        const q = quotes[Math.floor(Math.random() * quotes.length)];
        document.getElementById('quoteText').innerText = `ã€Œ${q}ã€`; // 2. ä¸è¦ä¾†æº
    }

    function updateEvolution() {
        const oldG = currentUser.g;
        currentG = { ch: document.getElementById('inCh').value, en: document.getElementById('inEn').value, ma: document.getElementById('inMa').value, sc: document.getElementById('inSc').value, so: document.getElementById('inSo').value };
        recalculateTime();
        document.getElementById('evoReport').style.display = 'block';
        const list = document.getElementById('evoList'); list.innerHTML = "";
        Object.keys(currentG).forEach(k => {
            const diff = pointMap[currentG[k]] - pointMap[oldG[k]];
            const tag = diff > 0 ? `<span style="color:var(--up)">â–²é€²æ­¥</span>` : (diff < 0 ? `<span style="color:var(--down)">â–¼é€€æ­¥</span>` : `<span style="color:#94a3b8">æŒå¹³</span>`);
            list.innerHTML += `<div style="font-size:0.85rem; margin-bottom:5px; display:flex; justify-content:space-between"><span>${subName[k]}</span> <span>${oldG[k]} â” ${currentG[k]} ${tag}</span></div>`;
        });
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function renderChart(g) {
        const m = {"A++":100,"A+":90,"A":80,"B++":65,"B+":55,"B":45,"C":20};
        const ctx = document.getElementById('radarChart').getContext('2d');
        if(window.myChart) window.myChart.destroy();
        window.myChart = new Chart(ctx, {
            type: 'radar',
            data: {
                labels: ['åœ‹', 'è‹±', 'æ•¸', 'è‡ª', 'ç¤¾'],
                datasets: [{ data: [m[g.ch], m[g.en], m[g.ma], m[g.sc], m[g.so]], backgroundColor: 'rgba(34, 211, 238, 0.2)', borderColor: '#22d3ee', borderWidth: 2 }]
            },
            options: { maintainAspectRatio: false, scales: { r: { grid:{color:'rgba(255,255,255,0.1)'}, ticks:{display:false}, suggestedMin:0, suggestedMax:100 } }, plugins:{legend:{display:false}} }
        });
    }

    window.onload = () => {
        const sel = document.getElementById('userSelect');
        db.forEach(s => { const o = document.createElement('option'); o.value=s.id; o.text=`${s.id < 10 ? '0'+s.id : s.id} - ${s.name}`; sel.appendChild(o); });
        const sim = document.getElementById('simInputs');
        ["Ch","En","Ma","Sc","So"].forEach(k => {
            const d = document.createElement('div'); d.innerHTML = `<label style="font-size:0.7rem; color:#94a3b8">${subName[k.toLowerCase()]}</label><select id="in${k}"></select>`;
            sim.appendChild(d);
            const subSel = document.getElementById('in' + k);
            ["A++","A+","A","B++","B+","B","C"].forEach(l => { const o = document.createElement('option'); o.value=o.text=l; subSel.appendChild(o); });
        });
        const wd = document.createElement('div'); wd.innerHTML = `<label style="font-size:0.7rem; color:#94a3b8">å¯«ä½œ</label><select id="inWrite"></select>`;
        sim.appendChild(wd);
        [6,5,4,3,2,1,0].forEach(v => { const o = document.createElement('option'); o.value=o.text=v; document.getElementById('inWrite').appendChild(o); });
    }
</script>
</body>
</html>