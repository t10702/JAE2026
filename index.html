<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 JAE | Growth Evolution</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --bg: #020617;
            --accent: #22d3ee;
            --gold: #f59e0b;
            --up: #4ade80;   /* é€²æ­¥è‰² */
            --down: #f87171; /* é€€æ­¥è‰² */
            --glass: rgba(15, 23, 42, 0.9);
            --border: rgba(34, 211, 238, 0.2);
        }

        body, html { margin: 0; padding: 0; min-height: 100vh; font-family: 'Segoe UI', 'Microsoft JhengHei', sans-serif; background-color: var(--bg); color: #fff; }

        /* --- ç™»å…¥ç•«é¢ --- */
        #loginWrapper {
            height: 100vh; width: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center;
            background: radial-gradient(circle at center, #1e293b 0%, #020617 100%);
            position: fixed; z-index: 1000; transition: 0.8s ease;
        }
        .game-title { font-size: clamp(2rem, 8vw, 4rem); font-weight: 900; letter-spacing: 5px; background: linear-gradient(to bottom, #fff, var(--accent)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin: 0; }
        .login-card { width: 85%; max-width: 400px; background: var(--glass); padding: 40px; border-radius: 30px; border: 1px solid var(--border); backdrop-filter: blur(15px); margin-top: 30px; }
        select, input { width: 100%; padding: 18px; margin: 10px 0; background: rgba(0,0,0,0.5); border: 1px solid #334155; border-radius: 12px; color: #fff; font-size: 1.1rem; box-sizing: border-box; }
        .btn-action { width: 100%; padding: 20px; border: none; border-radius: 12px; font-size: 1.3rem; font-weight: 800; cursor: pointer; transition: 0.3s; background: var(--accent); color: #020617; margin-top: 20px; }

        /* --- å ±è¡¨å…§å®¹ --- */
        #reportSection { display: none; max-width: 1200px; margin: 0 auto; padding: 40px 20px; }
        .header-box { background: var(--glass); border-radius: 30px; padding: 30px; display: flex; justify-content: space-between; align-items: center; border: 1px solid var(--border); margin-bottom: 25px; position: relative; }
        
        /* æˆé•·æ¨™ç±¤ */
        .growth-tag { position: absolute; top: -10px; right: 30px; padding: 5px 15px; border-radius: 20px; font-weight: 800; font-size: 0.9rem; }
        .growth-up { background: var(--up); color: #064e3b; }
        .growth-down { background: var(--down); color: #450a0a; }

        /* XP é€²åº¦æ¢ */
        .xp-header { display: flex; justify-content: space-between; font-size: 0.85rem; color: #94a3b8; margin-bottom: 8px; font-weight: bold; }
        .xp-bar-container { width: 300px; height: 12px; background: #1e293b; border-radius: 6px; overflow: hidden; border: 1px solid rgba(255,255,255,0.1); }
        .xp-bar-fill { height: 100%; background: linear-gradient(90deg, #06b6d4, #22d3ee); width: 0%; transition: 2.5s cubic-bezier(0.1, 1, 0.1, 1); }

        .stat-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-bottom: 25px; }
        .stat-card { background: var(--glass); padding: 20px; border-radius: 20px; text-align: center; border: 1px solid var(--border); }
        .stat-val { font-size: 2rem; font-weight: 900; color: var(--accent); display: block; }

        .main-layout { display: grid; grid-template-columns: 1.2fr 0.8fr; gap: 20px; }
        .card { background: var(--glass); border-radius: 25px; padding: 25px; border: 1px solid var(--border); }

        /* ä¿®æ”¹å¯†ç¢¼å½ˆçª— */
        #pwdModal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 90%; max-width: 350px; background: #0f172a; border: 2px solid var(--accent); padding: 30px; border-radius: 25px; z-index: 2000; }
        .overlay { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.8); z-index: 1500; }
    </style>
</head>
<body>

    <div id="loginWrapper">
        <h1 class="game-title">2026 JAE</h1>
        <div style="letter-spacing: 10px; color: #64748b; font-size: 0.8rem; margin-bottom: 30px;">9TH GRADE BATTLE REPORT</div>
        <div class="login-card">
            <select id="userSelect"><option value="">-- SELECT HERO --</option></select>
            <input type="password" id="userPass" placeholder="PASSCODE (308XX)">
            <button class="btn-action" onclick="handleLogin()">INITIALIZE</button>
        </div>
    </div>

    <div id="reportSection">
        <div class="header-box">
            <div id="growthTag" class="growth-tag"></div>
            <div style="display: flex; align-items: center;">
                <div id="rankOrb" style="width:90px; height:90px; border: 6px solid; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:3rem; font-weight:900; margin-right:25px;">?</div>
                <div>
                    <h2 id="displayName" style="margin:0; font-size: 2.5rem;">NAME</h2>
                    <div id="displayRank" style="color: var(--gold); font-weight: 800; font-size: 1.5rem;">RANK</div>
                    <div style="margin-top: 15px;">
                        <div class="xp-header">
                            <span id="nextLevelName">NEXT GOAL: ---</span>
                            <span id="xpRemaining">REMAINING: 0 XP</span>
                        </div>
                        <div class="xp-bar-container"><div id="xpFill" class="xp-bar-fill"></div></div>
                    </div>
                </div>
            </div>
            <div style="text-align: right;">
                <div style="font-size: 0.9rem; color: var(--accent); font-weight: bold;">TOTAL POWER (90+XP)</div>
                <div id="displayScore" style="font-size: 5.5rem; font-weight: 900; line-height:1;">0</div>
                <button onclick="openPwdModal()" style="background:none; border: 1px solid #475569; color:#475569; border-radius:5px; cursor:pointer; font-size:0.7rem; margin-top:10px;">ä¿®æ”¹å¯†ç¢¼</button>
            </div>
        </div>

        <div class="stat-grid">
            <div class="stat-card">ç­ç´šæ’å<span id="cRank" class="stat-val">-</span></div>
            <div class="stat-card">æ ¡å…§æ’å<span id="sRank" class="stat-val">-</span></div>
            <div class="stat-card">è€ƒå€æ’å<span id="dRank" class="stat-val">-</span></div>
            <div class="stat-card" style="border: 2px solid #f87171;">é ä¼°è½é»<span id="predictSchool" class="stat-val" style="font-size: 1.1rem; color:#fff;">-</span></div>
        </div>

        <div class="main-layout">
            <div class="card">
                <h3 style="margin-top:0; color:var(--accent);">ğŸ¯ æœ¬æ¬¡æˆ°å½¹æ”»ç•¥</h3>
                <div id="strategyList"></div>
            </div>
            <div class="card">
                <h3 style="margin-top:0; color:var(--accent);">ğŸ›¡ï¸ æˆ°åŠ›åˆ†å¸ƒ</h3>
                <div style="height: 300px;"><canvas id="radarChart"></canvas></div>
            </div>
        </div>
        
        <div onclick="location.reload()" style="text-align:center; color:#475569; margin:50px 0; cursor:pointer; letter-spacing:5px;">[ RETURN TO BASE ]</div>
    </div>

    <div id="overlay" class="overlay"></div>
    <div id="pwdModal">
        <h3 style="margin-top:0; color:var(--accent);">è®Šæ›´å®‰å…¨èªè­‰ç¢¼</h3>
        <input type="password" id="oldPwd" placeholder="ç›®å‰å¯†ç¢¼">
        <input type="password" id="newPwd" placeholder="æ–°å¯†ç¢¼">
        <button class="btn-action" onclick="submitNewPwd()">å„²å­˜è®Šæ›´</button>
        <button onclick="closePwdModal()" style="width:100%; background:none; border:none; color:#64748b; margin-top:15px; cursor:pointer;">å–æ¶ˆ</button>
    </div>

<script>
    // --- 1. 11æœˆç²¾æº–æ•¸æ“šåº« (å§“åã€ä¸‰é …æ’åã€5é …æ”»ç•¥) ---
    // ä¾æ“š 114.11.06 å ±è¡¨æ ¡å°ï¼šcRank=ç­åæ¬¡, sRank=æ ¡å…§åæ¬¡, dRank=è€ƒå€åæ¬¡
    const studentDB = [
        { id: 1, name: "ç‹æ˜±å¡", rank: "æ¦®è€€æ˜Ÿè¾°", score: 28, prevScore: 25, cRank: 12, sRank: 227, dRank: 2065, grades: {ch:"B+", en:"B", ma:"B++", sc:"B++", so:"A"}, s: ["ç¤¾æœƒç§‘è¡ä¸Š A ç´šï¼Œå±•ç¾å¼·å¤§é‚è¼¯èˆ‡èƒŒèª¦å¯¦åŠ›ã€‚","æ•¸å­¸èˆ‡è‡ªç„¶ç©©å®šç¶­æŒ B++ï¼Œæ˜¯æˆ°åŠ›çš„æ ¸å¿ƒæ”¯æŸ±ã€‚","åœ‹æ–‡ B+ è¡¨ç¾å°šå¯ï¼Œå»ºè­°åŠ å¼·æ–‡è¨€æ–‡é–±è®€é‡ã€‚","è‹±æ–‡å–®å­—é‡éœ€æŒçºŒæ“´å……ï¼Œç›®æ¨™æœ B++ é‚é€²ã€‚","æ•´é«”è¡¨ç¾å„ªç•°ï¼Œç›®æ¨™é–å®šå“¡ä¸­ä»¥ä¸Šå„ªè³ªé«˜ä¸­ã€‚"] },
        { id: 2, name: "å³å½¥å‹³", rank: "ä¸å±ˆé’éŠ…", score: 25, prevScore: 27, cRank: 15, sRank: 299, dRank: 3006, grades: {ch:"B+", en:"B", ma:"A", sc:"B++", so:"B"}, s: ["æ•¸å­¸ A ç´šè¡¨ç¾æ¥µç‚ºå‡ºè‰²ï¼Œæ˜¯ä½ çš„æœ€å¼·é€²æ”»æ­¦å™¨ã€‚","è‡ªç„¶ç§‘ B++ åº•å­ç´®å¯¦ï¼Œå¯åŠ å¼·å¯¦é©—é¡Œå‹ç·´ç¿’ã€‚","åœ‹æ–‡ B+ ç¶­æŒæ°´æº–ï¼Œå»ºè­°æå‡ä½œæ–‡å¯«ä½œæ·±åº¦ã€‚","ç¤¾æœƒèˆ‡è‹±æ–‡éœ€å¹³è¡¡æ™‚é–“åˆ†é…ï¼Œé¿å…æˆ°åŠ›æ–·å±¤ã€‚","ç›®å‰è™•æ–¼æ™‰éšé‚Šç·£ï¼Œä¸€ç§‘çªç ´å³å¯é€²å…¥æ¦®è€€æ˜Ÿè¾°ã€‚"] },
        { id: 3, name: "æè‡´è«­", rank: "ä¸å±ˆé’éŠ…", score: 23, prevScore: 23, cRank: 20, sRank: 351, dRank: 3751, grades: {ch:"B", en:"C", ma:"A", sc:"B", so:"B+"}, s: ["æ•¸å­¸ A ç´šæˆ°åŠ›é©šäººï¼Œåœ¨ç­ç´šä¸­å…·å‚™æ¥µå¼·ç«¶çˆ­åŠ›ã€‚","ç¤¾æœƒç§‘ B+ é€²æ­¥ä¸­ï¼Œåœ°åœ–èˆ‡åœ–è¡¨é¡Œæ˜¯å¾—åˆ†é—œéµã€‚","åœ‹æ–‡èˆ‡è‡ªç„¶ç¶­æŒ B ç´šï¼Œéœ€ç©©ä½åŸºç¤è§€å¿µé¡Œã€‚","è‹±æ–‡ C æ˜¯ç›®å‰æœ€å¤§é˜»ç¤™ï¼Œæ¯æ—¥èƒŒèª¦ 10 å€‹å–®å­—ã€‚","åªè¦è‹±æ–‡æˆåŠŸè„« Cï¼Œæ ¡æ’åæ¬¡å°‡è¿ä¾†çˆ†ç™¼æˆé•·ã€‚"] },
        { id: 4, name: "ææ™‰å®‰", rank: "å¾…è¦ºé†’", score: 20, prevScore: 18, cRank: 25, sRank: 419, dRank: 5065, grades: {ch:"B", en:"C", ma:"B+", sc:"B", so:"B"}, s: ["æ•¸å­¸ B+ å±•ç¾å‡ºè‰¯å¥½çš„é‚è¼¯æ½›åŠ›ã€‚","è‹±æ–‡èˆ‡åœ‹æ–‡åŸºç¤éœ€å†å¼·åŒ–ï¼Œç‰¹åˆ¥æ˜¯å–®å­—èˆ‡æ¨™é»ã€‚","è‡ªç„¶ç§‘èˆ‡ç¤¾æœƒç§‘ç¶­æŒåŸºæœ¬ç›¤ï¼Œè«‹å®ˆä½åŸºç¤é¡Œã€‚","å»ºè­°å„ªå…ˆæ‹¯æ•‘è‹±æ–‡ç§‘ï¼Œå¾åŸºç¤é–±è®€æ¸¬é©—åšèµ·ã€‚","å­¸ç¿’æ…‹åº¦ç©©å®šï¼Œä¿æŒè€æ€§å¿…èƒ½çœ‹åˆ°æˆ°åŠ›å›å‡ã€‚"] },
        { id: 5, name: "æ²ˆå®å½¥", rank: "æ¦®è€€æ˜Ÿè¾°", score: 31, prevScore: 29, cRank: 10, sRank: 142, dRank: 1250, grades: {ch:"A", en:"B", ma:"A", sc:"B++", so:"A"}, s: ["åœ‹ã€æ•¸ã€ç¤¾ä¸‰ A é”æˆï¼å±•ç¾å…¨æ–¹ä½å¼·å¤§å­¸åŠ›ã€‚","è‡ªç„¶ç§‘ B++ è·é›¢ A åƒ…ä¸€æ­¥ï¼Œå»ºè­°å°ˆæ”»ç†åŒ–å…¬å¼ã€‚","è‹±æ–‡ç§‘æ˜¯ç›®å‰å”¯ä¸€å¼±é …ï¼Œéœ€è£œå¼·é•·ç¯‡é–±è®€æŠ€å·§ã€‚","ç©©å±…å…¨ç­å‰ 10 åï¼Œå½°ä¸­éŒ„å–æ©Ÿæœƒå°±åœ¨çœ¼å‰ã€‚","å»ºè­°å¤šåšæ­·å±†è©¦é¡Œï¼Œç·´ç¿’æ‡‰è©¦é…é€Ÿä»¥ä¿æŒæ‰‹æ„Ÿã€‚"] },
        { id: 6, name: "å¼µäºå®—", rank: "å¾…è¦ºé†’", score: 20, prevScore: 19, cRank: 26, sRank: 427, dRank: 5326, grades: {ch:"C", en:"B", ma:"B+", sc:"B", so:"B"}, s: ["æ•¸å­¸ B+ èˆ‡è‹±æ–‡ B æ˜¯ä½ ç›®å‰çš„æ ¸å¿ƒé˜²ç¦¦ç·šã€‚","åœ‹æ–‡æ‰å…¥ C ç´šæ˜¯è­¦è¨Šï¼Œéœ€åŠ å¼·åŸºç¤åœ‹å­¸å¸¸è­˜ã€‚","è‡ªç„¶èˆ‡ç¤¾æœƒè¡¨ç¾æŒå¹³ï¼Œå»ºè­°å…ˆè®€æœ€æœ‰èˆˆè¶£çš„ä¸€ç§‘ã€‚","æ¯æ—¥å›ºå®šç·´ç¿’ä¸‰é¡Œæ•¸å­¸éé¸ï¼Œç´¯ç©ç­”é¡Œæ„Ÿã€‚","åªè¦æœ‰ä¸€ç§‘èƒ½è¡ä¸Š B++ï¼Œæˆ°åŠ›ç­‰ç´šå°‡ç¬é–“æå‡ã€‚"] },
        { id: 7, name: "æ¢æ¾„ç¥", rank: "å¾…è¦ºé†’", score: 18, prevScore: 18, cRank: 27, sRank: 460, dRank: 6423, grades: {ch:"B", en:"C", ma:"C", sc:"B", so:"B"}, s: ["åœ‹ã€è‡ªã€ç¤¾ç¶­æŒ B ç´šåŸºæœ¬ç›¤ï¼ŒåŸºæœ¬åŠŸå°šåœ¨ã€‚","æ•¸å­¸èˆ‡è‹±æ–‡å…©å¤§é–€ç¥å¡é—œï¼Œéœ€å„ªå…ˆè£œå¼·åŸºç¤ã€‚","è‹±æ–‡å»ºè­°å¾è½åŠ›è‘—æ‰‹ï¼Œé‚£æ˜¯æœ€å¥½æ‹¿åˆ†çš„éƒ¨åˆ†ã€‚","ç¤¾æœƒç§‘é€²æ­¥æ½›åŠ›å¤§ï¼Œå¤šçœ‹æ­·å²æ™‚é–“è»¸æ•´ç†ã€‚","åˆ¥ç°å¿ƒï¼å…ˆå®ˆä½ä¸‰ç§‘ Bï¼Œå†å°‹æ±‚é»ç‹€çªç ´ã€‚"] },
        { id: 8, name: "é™³å®¥äºˆ", rank: "å¾…è¦ºé†’", score: 12, prevScore: 15, cRank: 29, sRank: 499, dRank: 7712, grades: {ch:"C", en:"C", ma:"C", sc:"C", so:"C"}, s: ["ç›®å‰è™•æ–¼ä½è°·æœŸï¼Œé€™æ˜¯é‡æ–°ç›¤é»è³‡æºçš„å¥½æ™‚æ©Ÿã€‚","å…ˆå¾åœ‹æ–‡ç™½è©±æ–‡æ¸¬é©—é–‹å§‹ï¼Œå»ºç«‹è®€æ›¸çš„æˆå°±æ„Ÿã€‚","è‹±æ–‡å–®å­—æ¯å¤©åªèƒŒ 5 å€‹ä¹Ÿè¡Œï¼Œé‡é»æ˜¯ä¸èƒ½é–“æ–·ã€‚","æ•¸å­¸å…ˆæ±‚ç®—å°åŸºç¤å››å‰‡é‹ç®—ï¼Œæ‹¿ç©©åŸºæœ¬åˆ†ã€‚","è€å¸«æœƒé™ªä½ ä¸€èµ·åŠªåŠ›ï¼Œæ‰¾å‡ºä¸€ç§‘å–œæ­¡çš„é–‹å§‹çªç ´ã€‚"] },
        { id: 9, name: "é™³ç¥å‘ˆ", rank: "æ¦®è€€æ˜Ÿè¾°", score: 34, prevScore: 34, cRank: 7, sRank: 94, dRank: 757, grades: {ch:"A", en:"A", ma:"B++", sc:"B++", so:"A"}, s: ["åœ‹ã€è‹±ã€ç¤¾ä¸‰ A ç‹è€…ï¼Œæ ¡æ’é€²å…¥å‰ 100 å¼·ï¼","æ•¸å­¸èˆ‡è‡ªç„¶ç©©å®šåœ¨ B++ï¼Œå…·å‚™å„ªç§€çš„é‚è¼¯åŸºç¤ã€‚","è‹¥èƒ½å°‡æ•¸å­¸æ¨å‘ A ç´šï¼Œå°‡è§£é–æ›´é«˜éšå­¸æ ¡é–€æª»ã€‚","è‹±æ–‡ A ç´šè¡¨ç¾å„ªç•°ï¼Œå»ºè­°å¤šé–±è®€é€²éšé›œèªŒã€‚","ç›®å‰å¯¦åŠ›éå¸¸ç©©å¥ï¼Œæ˜¯ 308 ç­çš„é ‚å°–æˆ°åŠ›ã€‚"] },
        { id: 10, name: "é™³ç¿å®", rank: "ä¸å±ˆé’éŠ…", score: 23, prevScore: 26, cRank: 21, sRank: 354, dRank: 3800, grades: {ch:"B", en:"B", ma:"B", sc:"B", so:"B"}, s: ["å…¨ç§‘çš† Bï¼è¡¨ç¾æ¥µåº¦å‡è¡¡ï¼Œåº•å­ç´®å¯¦ã€‚","é€™ä¹Ÿä»£è¡¨ä½ æ²’æœ‰æ˜é¡¯å¼±é»ï¼Œåªè¦æ¨ä¸€æŠŠå°±èµ·é£›ã€‚","å»ºè­°é¸å®šç¤¾æœƒç§‘å…ˆè¡Œè¡åˆºï¼Œé€™ç§‘æœ€å¿«è¦‹åˆ° Aã€‚","è‹±æ–‡ç§‘å–®å­—ç†Ÿç·´åº¦éœ€åŠ å¼·ï¼Œæ¸›å°‘é–±è®€æ™‚çš„ç”Ÿå­—æ„Ÿã€‚","ç¶­æŒä½œæ¯ç©©å®šï¼Œä½ æ˜¯ç­ä¸Šæœ€æœ‰æ½›åŠ›å¤§çˆ†ç™¼çš„åŒå­¸ã€‚"] },
        { id: 11, name: "é»ƒç…’å‡±", rank: "ä¸å±ˆé’éŠ…", score: 25, prevScore: 22, cRank: 14, sRank: 297, dRank: 2988, grades: {ch:"B++", en:"B", ma:"B+", sc:"B+", so:"B"}, s: ["åœ‹æ–‡è¡ä¸Š B++ï¼Œèªæ–‡æ„Ÿé¡¯è‘—æå‡ã€‚","æ•¸å­¸èˆ‡è‡ªç„¶çš†æœ‰ B+ï¼Œæˆ°åŠ›åˆ†ä½ˆå¥åº·ã€‚","ç¤¾æœƒç§‘ä»æœ‰é€²æ­¥ç©ºé–“ï¼Œå¤šè¤‡ç¿’åœ°ç†åœ–è¡¨ã€‚","è‹±æ–‡ç§‘è½åŠ›è¡¨ç¾å„ªæ–¼é–±è®€ï¼Œå¯åŠ å¼·å…‹æ¼å­—ç·´ç¿’ã€‚","æ•´é«”åæ¬¡ç©©æ­¥ä¸Šæšï¼Œç¹¼çºŒä¿æŒé€™è‚¡é€²åŒ–çš„æ°£å‹¢ã€‚"] },
        { id: 12, name: "é»ƒå³»å”¯", rank: "ç’€ç’¨å‚³èªª", score: 36, prevScore: 30, cRank: 6, sRank: 67, dRank: 468, grades: {ch:"A++", en:"B+", ma:"A", sc:"A", so:"A"}, s: ["åœ‹æ–‡ A++ å°é ‚ï¼å±•ç¾ç‹è€…ç´šåˆ¥çš„é–±è®€èƒ½åŠ›ã€‚","æ•¸ã€è‡ªã€ç¤¾ä¸‰ç§‘çš† Aï¼Œæ ¡æ’ç¬¬ 67 åå¯¦åŠ›å¼·æ‚ã€‚","è‹±æ–‡ B+ æ˜¯ç›®å‰å”¯ä¸€çš„é€²éšé˜»ç¤™ï¼Œéœ€åŠ å¼·æ–‡æ³•ã€‚","ç›®æ¨™æ˜ç¢ºé–å®šå½°ä¸­ï¼Œç›®å‰çš„è®€æ›¸ç¯€å¥éå¸¸æˆåŠŸã€‚","å»ºè­°æ¯æ—¥å›ºå®šåš 1 å›è‹±æ–‡æ¸¬é©—ï¼Œä¿æŒé¡Œæ„Ÿã€‚"] },
        { id: 13, name: "æ¥Šçš“å®‡", rank: "ä¸å±ˆé’éŠ…", score: 22, prevScore: 21, cRank: 22, sRank: 358, dRank: 3865, grades: {ch:"B", en:"B", ma:"B+", sc:"B", so:"B++"}, s: ["ç¤¾æœƒ B++ èˆ‡æ•¸å­¸ B+ æ˜¯ç›®å‰çš„å¾—åˆ†é›™ç®­é ­ã€‚","åœ‹ã€è‹±ã€è‡ªç¶­æŒåœ¨ B ç´šï¼Œè¡¨ç¾ç›¸ç•¶ç©©å®šã€‚","ç¤¾æœƒç§‘è·é›¢ A åƒ…å·®ä¸€æ­¥ï¼Œè€ƒå‰å¤šçœ‹é‡é»æ•´ç†ã€‚","è‹±æ–‡å–®å­—è¤‡ç¿’é »ç‡éœ€æå‡ï¼Œä»¥æ¸›å°‘é–±è®€è² æ“”ã€‚","ç›®æ¨™ï¼šä¸‹å€‹æœˆå°‡ç¤¾æœƒæ¨å‘ Aï¼Œåæ¬¡å°‡å¾€å‰è·³ 5 ä½ã€‚"] },
        { id: 14, name: "åŠ‰ä¸æ©", rank: "å¾…è¦ºé†’", score: 18, prevScore: 18, cRank: 28, sRank: 463, dRank: 6492, grades: {ch:"B", en:"C", ma:"B", sc:"C", so:"B"}, s: ["åœ‹ã€æ•¸ã€ç¤¾ä¸‰ç§‘å®ˆä½ B ç´šé˜²ç·šï¼Œè¡¨ç¾åˆæ ¼ã€‚","è‹±æ–‡èˆ‡è‡ªç„¶æ‰å…¥ C ç´šï¼Œéœ€é‡å°æ ¸å¿ƒé‡é»è£œå¼·ã€‚","è‡ªç„¶ç§‘ç†åŒ–åŸºç¤éœ€å¤šç·´ç¿’ï¼Œå¯å¾èª²æœ¬ç¿’é¡Œåšèµ·ã€‚","è‹±æ–‡å–®å­—æ˜¯ç›®å‰é¦–è¦ä»»å‹™ï¼Œä¸å¯å®Œå…¨æ”¾æ£„ã€‚","ç¶­æŒè®€æ›¸æ­¥èª¿ï¼Œä¸è¦è¢«æš«æ™‚çš„åæ¬¡æ³¢å‹•å½±éŸ¿ä¿¡å¿ƒã€‚"] },
        { id: 15, name: "åŠ‰å®¥æ‰¿", rank: "æ¦®è€€æ˜Ÿè¾°", score: 31, prevScore: 29, cRank: 11, sRank: 148, dRank: 1325, grades: {ch:"B++", en:"B++", ma:"A", sc:"B++", so:"A"}, s: ["æ•¸å­¸èˆ‡ç¤¾æœƒé›™ A é”æˆï¼Œé‚è¼¯èˆ‡è¨˜æ†¶èƒ½åŠ›ä¿±ä½³ã€‚","åœ‹ã€è‹±ã€è‡ªä¸‰ç§‘çš† B++ï¼Œé€™æ˜¯ä¸€ä»½æ¥µå…·ç«¶çˆ­åŠ›çš„æˆç¸¾ã€‚","è‹¥å°‡åœ‹æ–‡æ¨å‘ A ç´šï¼Œç¸½ç©åˆ†å°‡è¡ç ´ 125 åˆ†ã€‚","è‡ªç„¶ç§‘å¯¦é©—èˆ‡æ¨è«–é¡Œå‹éœ€å¤šåŠ ç•™æ„ã€‚","ç›®æ¨™é–å®šå“¡ä¸­ã€å½°ä¸­ï¼Œå¯¦åŠ›å·²éå¸¸æ¥è¿‘é–€æª»ã€‚"] },
        { id: 16, name: "åŠ‰ç…¥é¨°", rank: "ç’€ç’¨å‚³èªª", score: 39, prevScore: 40, cRank: 2, sRank: 40, dRank: 232, grades: {ch:"A++", en:"B++", ma:"A", sc:"A++", so:"A++"}, s: ["ä¸‰ç§‘ A++ ç‹è€…å¯¦åŠ›ï¼åœ‹ã€è‡ªã€ç¤¾ç©©å®šåˆ¶éœ¸ã€‚","æ•¸å­¸ A ç´šè¡¨ç¾æ¥µä½³ï¼Œè‹±æ–‡ B++ äº¦ç¶­æŒæ°´æº–ã€‚","ç›®å‰æ ¡æ’å‰ 40ï¼Œå½°ä¸­éŒ„å–è³‡æ ¼æ¥µåº¦ç©©å®šã€‚","å»ºè­°è‹±æ–‡ç§‘åŠ å¼·å–®å­—æ·±åº¦ï¼ŒæŒ‘æˆ° A ç´šæ®¿å ‚ã€‚","ä¿æŒå¹³å¸¸å¿ƒæ‡‰è€ƒï¼Œä½ å·²ç¶“å…·å‚™æ¦œé¦–ç­‰ç´šçš„å¯¦åŠ›ã€‚"] },
        { id: 17, name: "æ´ªæ¹˜èŠ¸", rank: "ä¸å±ˆé’éŠ…", score: 27, prevScore: 25, cRank: 13, sRank: 234, dRank: 2191, grades: {ch:"B++", en:"B+", ma:"C", sc:"B+", so:"A+"}, s: ["ç¤¾æœƒ A+ é©šè‰·å…¨å ´ï¼Œé€™æ˜¯ä½ æœ€å¼·çš„é€²æ”»æ­¦å™¨ï¼","åœ‹æ–‡ B++ åº•å­å¥½ï¼Œè‹¥å¤šè®€æ–‡è¨€æ–‡æœ‰æ©Ÿæœƒè¡ Aã€‚","æ•¸å­¸ç§‘è½å…¥ C ç´šæ˜¯ç›®å‰è»Ÿè‚‹ï¼Œéœ€é‡æ‹¾åŸºç¤é¡Œã€‚","è‡ªç„¶èˆ‡è‹±æ–‡çš†æœ‰ B+ï¼Œè·é›¢ B++ åƒ…ä¸€æ­¥ä¹‹é™ã€‚","åªè¦æ•‘èµ·æ•¸å­¸åŸºæœ¬åˆ†ï¼Œä½ çš„åæ¬¡å°‡æœƒé£›èºã€‚"] },
        { id: 18, name: "èƒ¡èªå½¤", rank: "ä¸å±ˆé’éŠ…", score: 25, prevScore: 26, cRank: 16, sRank: 303, dRank: 3117, grades: {ch:"B", en:"B++", ma:"B++", sc:"B", so:"B"}, s: ["è‹±æ–‡èˆ‡æ•¸å­¸é›™ B++ï¼Œå±•ç¾å‡ºè‰²çš„æ–‡ç†ç†è§£åŠ›ã€‚","åœ‹ã€è‡ªã€ç¤¾ä¸‰ç§‘éœ€ç©©ç´®ç©©æ‰“ï¼Œå®ˆä½ B ç´šé˜²ç·šã€‚","ç¤¾æœƒç§‘å»ºè­°åˆ©ç”¨å¿ƒæ™ºåœ–æ•´ç†ï¼Œæ¸›å°‘ç‘£ç¢è¨˜æ†¶å¤±èª¤ã€‚","è‡ªç„¶ç§‘ç†åŒ–éƒ¨åˆ†éœ€åŠ å¼·è¨ˆç®—é¡Œçš„ç²¾æº–åº¦ã€‚","ç›®å‰æˆ°åŠ›éå¸¸å‡è¡¡ï¼Œç›®æ¨™æ˜¯æ”»å…‹ç¬¬ä¸€å€‹ Aã€‚"] },
        { id: 19, name: "å¼µæ™ç¿", rank: "å¾…è¦ºé†’", score: 24, prevScore: 22, cRank: 17, sRank: 329, dRank: 3352, grades: {ch:"B+", en:"B", ma:"B", sc:"B", so:"B+"}, s: ["åœ‹æ–‡èˆ‡ç¤¾æœƒçš†æœ‰ B+ï¼Œæ–‡ç§‘å¯¦åŠ›å…·å‚™åŸºæœ¬ç›¤ã€‚","æ•¸ã€è‹±ã€è‡ªç¶­æŒåœ¨ B ç´šï¼Œè¡¨ç¾ç©©å¥ã€‚","å»ºè­°å°ˆæ”»ç¤¾æœƒç§‘ï¼Œé€™æ˜¯ç›®å‰æœ€æœ‰æ©Ÿæœƒè¡ B++ çš„é …ç›®ã€‚","è‹±æ–‡é–±è®€é€Ÿåº¦éœ€å†åŠ å¿«ï¼Œå»ºè­°æ¯æ—¥è®€ä¸€ç¯‡çŸ­æ–‡ã€‚","ç¶­æŒç©©å®šçš„å‡ºå¸­èˆ‡ç·´ç¿’ï¼Œæˆ°åŠ›æ­£åœ¨ç©©æ­¥å›å‡ä¸­ã€‚"] },
        { id: 20, name: "å¼µå‡±è–°", rank: "ä¸å±ˆé’éŠ…", score: 22, prevScore: 26, cRank: 23, sRank: 365, dRank: 3981, grades: {ch:"B", en:"B+", ma:"B", sc:"C", so:"B"}, s: ["è‹±æ–‡ B+ æ˜¯ç›®å‰è¡¨ç¾æœ€çªå‡ºçš„ç§‘ç›®ï¼Œè«‹ç¹¼çºŒä¿æŒã€‚","åœ‹ã€æ•¸ã€ç¤¾å®ˆä½ B ç´šï¼ŒåŸºæœ¬æˆ°åŠ›å°šå­˜ã€‚","è‡ªç„¶ç§‘æ‰å…¥ C ç´šéœ€è­¦æƒ•ï¼Œå»ºè­°é‡æ–°è¤‡ç¿’ç”Ÿç‰©è§€å¿µã€‚","ç¤¾æœƒç§‘å¤šçœ‹åœ°åœ–ï¼Œé€™èƒ½å¹«åŠ©ä½ æ›´å¥½ç†è§£é¡Œç›®ã€‚","ä¸è¦æ°£é¤’ï¼Œæ‰¾å› 9 æœˆä»½çš„ç¯€å¥ï¼Œä½ ä¸€å®šèƒ½é‡å›å‰æ®µç­ã€‚"] },
        { id: 21, name: "è¨±æ™¶è", rank: "å¾…è¦ºé†’", score: 24, prevScore: 25, cRank: 18, sRank: 333, dRank: 3372, grades: {ch:"B+", en:"C", ma:"B+", sc:"B++", so:"B"}, s: ["è‡ªç„¶ B++ å±•ç¾äº†æ¥µä½³çš„ç†ç§‘æ½›åŠ›ï¼Œéå¸¸å„ªç§€ï¼","åœ‹æ–‡èˆ‡æ•¸å­¸çš†æœ‰ B+ï¼Œæˆ°åŠ›åˆ†ä½ˆå…·å‚™ç«¶çˆ­åŠ›ã€‚","è‹±æ–‡ C ç´šæ˜¯é‡å‚·ï¼Œéœ€å¾æœ€åŸºç¤çš„å–®å­—å°å¡èƒŒèµ·ã€‚","ç¤¾æœƒç§‘ç©©å®šåº¦éœ€æå‡ï¼Œå¤šç·´ç¿’è·¨è¡¨çµ±åˆé¡Œã€‚","åªè¦è‹±æ–‡èƒ½å› Bï¼Œä½ çš„æ’åå°‡æœƒå‰é€²éå¸¸å¤šã€‚"] },
        { id: 22, name: "é»ƒç­±è", rank: "ç’€ç’¨å‚³èªª", score: 37, prevScore: 38, cRank: 3, sRank: 23, dRank: 357, grades: {ch:"A+", en:"B+", ma:"B++", sc:"A++", so:"A++"}, s: ["è‡ªç„¶èˆ‡ç¤¾æœƒé›™ A++ï¼å±•ç¾çµ±æ²»ç´šçš„ç†ç¤¾å¯¦åŠ›ã€‚","åœ‹æ–‡ A+ æ¥µåº¦ç©©å¥ï¼Œæ ¡æ’ç¬¬ 23 åéå¸¸å“è¶Šã€‚","æ•¸å­¸èˆ‡è‹±æ–‡å…·å‚™ B++ ä»¥ä¸Šå¯¦åŠ›ï¼Œå…·å‚™é€²æ­¥ç©ºé–“ã€‚","ç›®æ¨™æ˜ç¢ºé–å®šå½°å¥³ï¼Œä¿æŒç›®å‰çš„è¡åˆºç†±åº¦ã€‚","å»ºè­°åˆ†é…å°‘è¨±æ™‚é–“çµ¦è‹±æ–‡é–±è®€ï¼ŒæŒ‘æˆ° A ç´šã€‚"] },
        { id: 23, name: "é»ƒå¿ƒæ¸", rank: "æ¦®è€€æ˜Ÿè¾°", score: 32, prevScore: 30, cRank: 9, sRank: 66, dRank: 1126, grades: {ch:"B++", en:"B++", ma:"A++", sc:"B++", so:"A"}, s: ["æ•¸å­¸ A++ å°é ‚ï¼å±•ç¾é©šäººçš„é‚è¼¯è§£é¡Œå¯¦åŠ›ã€‚","ç¤¾æœƒ A ç´šåŒæ¨£è€€çœ¼ï¼Œæ–‡ç†é›™ä¿®æ˜¯ä½ çš„å¼·é …ã€‚","åœ‹ã€è‹±ã€è‡ªå…¨æ•¸ B++ï¼Œé€™æ˜¯ä¸€ä»½éå¸¸å®Œç¾çš„å ±è¡¨ã€‚","æ ¡æ’ç¬¬ 66 åï¼Œå¯¦åŠ›å®Œå…¨è¶³ä»¥æŒ‘æˆ°å½°ä¸­å½°å¥³ã€‚","ç›®æ¨™ï¼šå°‡è‹±æ–‡æˆ–è‡ªç„¶æ¨å‘ A ç´šï¼Œç¸½ç©åˆ†å°‡ç ´ 125ã€‚"] },
        { id: 24, name: "ç«¥è‹¥ç‘„", rank: "ç’€ç’¨å‚³èªª", score: 37, prevScore: 36, cRank: 5, sRank: 27, dRank: 393, grades: {ch:"A", en:"B++", ma:"A", sc:"A", so:"A"}, s: ["å››ç§‘çš† Aï¼æ ¡æ’ç¬¬ 27 åï¼Œå…¨æ‰å‹é¸æ‰‹ä»£è¡¨ã€‚","è‹±æ–‡ B++ è·é›¢ A åƒ…ä¸€æ­¥ä¹‹é™ï¼Œå»ºè­°åŠ å¼·è½åŠ›ã€‚","åœ‹ã€æ•¸ã€è‡ªã€ç¤¾å››ç§‘è¡¨ç¾æ¥µåº¦ç©©å®šï¼Œç„¡å¼±é …ã€‚","å¯¦åŠ›å®Œå…¨å‹ä»»å½°å¥³éŒ„å–è³‡æ ¼ï¼Œè«‹ç¶­æŒå¿ƒæ…‹ã€‚","å»ºè­°å¤šåšæ­·å±†è©¦é¡Œç·´ç¿’ï¼Œç£¨ç·´è€ƒè©¦æŠ—å£“åŠ›ã€‚"] },
        { id: 25, name: "é»ƒå¯€è¡", rank: "å¾…è¦ºé†’", score: 15, prevScore: 15, cRank: 29, sRank: 499, dRank: 7712, grades: {ch:"C", en:"C", ma:"C", sc:"C", so:"C"}, s: ["ç›®å‰æˆ°åŠ›è™•æ–¼æ½›ä¼æœŸï¼Œéœ€è¦ä¸€å€‹çªç ´å£ã€‚","å»ºè­°å¾æœ€æ‹¿æ‰‹çš„ç§‘ç›®é–‹å§‹è®€ï¼Œæ¯å¤©åŠå°æ™‚ã€‚","è‹±æ–‡å–®å­—ä¸è¦æ€¥è‘—èƒŒå¤šï¼Œå…ˆæ±‚æŠŠèª²æœ¬èƒŒç†Ÿã€‚","ç¤¾æœƒç§‘å¯ä»¥å¤šçœ‹æ­·å²æ•…äº‹ï¼ŒåŸ¹é¤Šå°å­¸ç§‘çš„èˆˆè¶£ã€‚","åŠ æ²¹ï¼åªè¦æœ‰ä¸€ç§‘è¡å‡º Cï¼Œä½ çš„æˆ°åŠ›å°±æœƒè¦ºé†’ã€‚"] },
        { id: 26, name: "è©¹æ²›ç’‡", rank: "ä¸å±ˆé’éŠ…", score: 23, prevScore: 28, cRank: 19, sRank: 339, dRank: 3502, grades: {ch:"B", en:"B+", ma:"B", sc:"B", so:"B"}, s: ["å…¨ç§‘çš† B ä»¥ä¸Šï¼Œè¡¨ç¾æ¥µå…¶ç©©å®šï¼Œæ˜¯ç­ä¸Šä¸­å …åŠ›é‡ã€‚","è‹±æ–‡ B+ è¡¨ç¾è‰¯å¥½ï¼Œå»ºè­°æœ B++ ç™¼èµ·é€²æ”»ã€‚","åœ‹ã€æ•¸ã€è‡ªã€ç¤¾å„ç§‘åˆ†æ•¸æ¥è¿‘ï¼Œéœ€å°‹æ‰¾çªç ´äº®é»ã€‚","å»ºè­°ç¤¾æœƒç§‘å¤šèŠ±é»å¿ƒæ€ï¼Œé€™ç§‘æœ€æœ‰æ©Ÿæœƒè®Š Aã€‚","ç›®å‰åæ¬¡ç©©å®šï¼Œè«‹ä¿æŒè®€æ›¸ç¯€å¥ï¼Œåˆ‡å‹¿ç„¦èºã€‚"] },
        { id: 27, name: "å»–å©•æ¸", rank: "å¾…è¦ºé†’", score: 16, prevScore: 19, cRank: 20, sRank: 412, dRank: 4886, grades: {ch:"B", en:"B", ma:"C", sc:"B", so:"C"}, s: ["åœ‹ã€è‹±ã€è‡ªä¸‰ç§‘å®ˆä½ B ç´šé˜²ç¦¦ï¼Œå±•ç¾åŸºæœ¬å¯¦åŠ›ã€‚","æ•¸å­¸èˆ‡ç¤¾æœƒæ‰å…¥ C ç´šï¼Œéœ€å„˜å¿«å›é ­è¤‡ç¿’åŸºç¤ã€‚","ç¤¾æœƒç§‘å»ºè­°å…ˆè®€åœ°ç†ï¼Œé€éçœ‹åœ–ç†è§£ä¾†å»ºç«‹ä¿¡å¿ƒã€‚","è‹±æ–‡ç§‘ç¶­æŒå¾—ä¸éŒ¯ï¼Œå»ºè­°å¤šè½è½èª²æ–‡å°è©±ã€‚","ä¸è¦è¢«æš«æ™‚çš„åæ¬¡æ‰“æ“Šï¼ŒåŸºç¤é‚„åœ¨ï¼Œæœ‰æ©Ÿæœƒç¿»ç›¤ã€‚"] },
        { id: 28, name: "åŠ‰èŠ®ç‘œ", rank: "ç’€ç’¨å‚³èªª", score: 37, prevScore: 37, cRank: 4, sRank: 24, dRank: 363, grades: {ch:"A++", en:"B++", ma:"A", sc:"A", so:"A"}, s: ["åœ‹æ–‡ A++ å°é ‚ï¼ä¸‰å† ç‹å¯¦åŠ›ç„¡åº¸ç½®ç–‘ã€‚","æ ¡æ’ç¬¬ 24 åï¼Œé€™ä»½æˆ°å ±è¶³ä»¥å‚²è¦–å…¨ç­ã€‚","è‹±æ–‡ B++ å…·å‚™è¡ A æ½›åŠ›ï¼Œå»ºè­°åŠ å¼·æ–‡æ³•ç†Ÿç·´åº¦ã€‚","æ•¸ã€è‡ªã€ç¤¾è¡¨ç¾å„ªç•°ï¼Œç¶­æŒç¾ç‹€å³å¯ã€‚","ç›®æ¨™é–å®šå½°å¥³ï¼Œä½ æ˜¯ 308 ç­çš„é ‚ç´šæˆ°åŠ›æ¨™ç«¿ã€‚"] },
        { id: 29, name: "æ½˜æ›‰éš", rank: "æ¦®è€€æ˜Ÿè¾°", score: 33, prevScore: 27, cRank: 8, sRank: 109, dRank: 908, grades: {ch:"A+", en:"B++", ma:"B++", sc:"B++", so:"B++"}, s: ["åœ‹æ–‡ A+ é ˜è»ï¼å±•ç¾æ¥µå¼·çš„èªæ–‡èˆ‡é‚è¼¯å„ªå‹¢ã€‚","å…¶é¤˜å››ç§‘å…¨æ•¸ B++ï¼Œé€™æ˜¯éå¸¸æ¨™æº–çš„ã€Œæˆ°åŠ›å‡è¡¡ã€ã€‚","è‹¥èƒ½å°‡å…¶ä¸­ä¸€ç§‘ç†ç§‘æ¨å‘ Aï¼Œå°‡ç”¢ç”Ÿè³ªè®Šã€‚","æ ¡æ’ 109 åï¼Œå…·å‚™æŒ‘æˆ°å½°ä¸­å½°å¥³çš„ç´®å¯¦åº•å­ã€‚","é€²æ­¥ 6 åˆ†è¡¨ç¾ç¥å‹‡ï¼Œæ˜¯ 11 æœˆä»½çš„é€²æ­¥çäººé¸ã€‚"] },
        { id: 30, name: "è¬æ²›ç’‡", rank: "è‡³å°Šå‚³èªª", score: 41, prevScore: 42, cRank: 1, sRank: 11, dRank: 99, grades: {ch:"A++", en:"A", ma:"A", sc:"A++", so:"A++"}, s: ["308 ç­æœ€å¼·å‚³èªªï¼ä¸‰ç§‘ A++ ç©©å®šå£“åˆ¶ã€‚","æ ¡æ’ç¬¬ 11 åï¼Œè€ƒå€æ’åå‰ 100 å¼·ã€‚","æ•¸å­¸èˆ‡è‹±æ–‡ç©©å®šåœ¨ A ç´šï¼Œæˆ°åŠ›çµæ§‹æ¯«ç„¡ç ´ç¶»ã€‚","å½°å¥³éŒ„å–è³‡æ ¼å·²æ˜¯å›Šä¸­ä¹‹ç‰©ï¼Œç›®æ¨™åœ¨æ–¼å…¨ç¸£æ’åã€‚","å»ºè­°ä¿æŒç›®å‰çš„å­¸ç¿’ç¯€å¥ï¼Œå¤šä¼‘æ¯ç¶­æŒé«”åŠ›ã€‚"] }
    ];

    // --- 2. å„ç­‰ç´šåœ–ç¤ºèˆ‡åƒæ•¸ ---
    const rankConfigs = {
        "è‡³å°Šå‚³èªª": { icon: "ğŸ‘‘", color: "#f59e0b", label: "L" }, 
        "ç’€ç’¨å‚³èªª": { icon: "ğŸ’", color: "#22d3ee", label: "S" }, 
        "æ¦®è€€æ˜Ÿè¾°": { icon: "ğŸŒŸ", color: "#818cf8", label: "A" }, 
        "ä¸å±ˆé’éŠ…": { icon: "ğŸ›¡ï¸", color: "#94a3b8", label: "B" }, 
        "å¾…è¦ºé†’":   { icon: "ğŸ”¥", color: "#f87171", label: "E" }
    };

    const thresholds = [
        { score: 104, name: "å„ªè³ªæŠ€è·é–€æª»" },
        { score: 109, name: "å“¡å®¶å®¶æ”¿ / åŒ—å®¶å•†ç¶“" },
        { score: 112, name: "æºªæ¹–é«˜ä¸­ / å½°å•†å•†ç¶“" },
        { score: 116, name: "å½°å·¥é›»æ©Ÿ / å½°å•†æ‡‰å¤–" },
        { score: 120, name: "å½°ä¸­ / å½°å¥³" }
    ];

    // --- 3. åˆå§‹åŒ–é¸å–® ---
    function initApp() {
        const selectEl = document.getElementById('userSelect');
        if (!selectEl) return;
        selectEl.innerHTML = '<option value="">-- è«‹é¸æ“‡ 11æœˆè‹±é›„ --</option>';
        studentDB.sort((a,b) => a.id - b.id).forEach(s => {
            const opt = document.createElement('option');
            opt.value = s.id;
            opt.textContent = `${s.id < 10 ? '0'+s.id : s.id} - ${s.name}`;
            selectEl.appendChild(opt);
        });
    }
    
    // ç¢ºä¿ DOM è¼‰å…¥å¾ŒåŸ·è¡Œ
    document.addEventListener('DOMContentLoaded', initApp);

    // --- 4. ç™»å…¥é‚è¼¯ ---
    function handleLogin() {
        const sid = document.getElementById('userSelect').value;
        const inputPass = document.getElementById('userPass').value;
        const savedPass = localStorage.getItem('pwd_' + sid) || "308" + (sid < 10 ? '0'+sid : sid);
        
        if(!sid) { alert("è«‹é¸æ“‡å­¸ç”Ÿå§“å"); return; }
        if(inputPass === savedPass) {
            document.getElementById('loginWrapper').style.opacity = "0";
            setTimeout(() => { 
                document.getElementById('loginWrapper').style.display = "none"; 
                showReport(sid); 
            }, 600);
        } else {
            alert("å¯†ç¢¼éŒ¯èª¤ï¼æç¤ºï¼š308 + åº§è™Ÿ (å…±5ç¢¼)");
        }
    }

    // --- 5. é¡¯ç¤ºå ±è¡¨ (ç²¾æº–å‘ˆç¾ä¸‰å¤§æ’å) ---
    function showReport(id) {
        const s = studentDB.find(item => item.id == id);
        const total = 90 + s.score;
        const config = rankConfigs[s.rank] || rankConfigs["å¾…è¦ºé†’"];

        document.getElementById('reportSection').style.display = "block";
        document.getElementById('displayName').innerText = s.name;
        document.getElementById('displayScore').innerText = total;
        document.getElementById('displayRank').innerText = s.rank;
        
        // æ ¸å¿ƒä¿®æ­£ï¼šå‘ˆç¾ç­ã€æ ¡ã€å€æ’å
        document.getElementById('cRank').innerText = s.cRank;
        document.getElementById('sRank').innerText = s.sRank;
        document.getElementById('dRank').innerText = s.dRank;

        // åœ–ç¤ºæ›´æ–°
        const orb = document.getElementById('rankOrb');
        if (orb) {
            orb.innerHTML = `<span style="font-size: 1.2rem; position: absolute; top: -5px;">${config.icon}</span>${config.label}`;
            orb.style.borderColor = config.color;
            orb.style.color = config.color;
            orb.style.boxShadow = `0 0 15px ${config.color}44`;
        }

        // æˆé•·æ¨™ç±¤
        const growthTag = document.getElementById('growthTag');
        const diff = s.score - s.prevScore;
        if (diff > 0) {
            growthTag.innerText = `â–² æˆ°åŠ›é€²åŒ– +${diff}`;
            growthTag.className = "growth-tag growth-up";
        } else if (diff < 0) {
            growthTag.innerText = `â–¼ æˆ°åŠ›èµ·ä¼ ${diff}`;
            growthTag.className = "growth-tag growth-down";
        } else {
            growthTag.innerText = "â— æˆ°åŠ›å¹³ç©©";
            growthTag.style.background = "#475569";
        }

        // XP é€²åº¦æ¢
        const nextGoal = thresholds.find(t => t.score > total) || thresholds[thresholds.length-1];
        const prevGoalScore = (thresholds.slice().reverse().find(t => t.score <= total)?.score || 90);
        const progress = ((total - prevGoalScore) / (nextGoal.score - prevGoalScore)) * 100;
        document.getElementById('nextLevelName').innerText = `ä¸‹ä¸€ç›®æ¨™ï¼š${nextGoal.name}`;
        document.getElementById('xpRemaining').innerText = nextGoal.score > total ? `å°šéœ€ï¼š${nextGoal.score - total} åˆ†` : "é ‚å°–æˆ°åŠ›";
        document.getElementById('xpFill').style.width = Math.max(10, progress) + "%";

        // æˆ°ç•¥æ”»ç•¥ (å®Œæ•´ 5 é …å‘ˆç¾)
        const list = document.getElementById('strategyList');
        list.innerHTML = "";
        s.s.forEach((text, index) => {
            const div = document.createElement('div');
            div.style.padding = "12px 15px"; div.style.marginBottom = "8px";
            div.style.background = "rgba(255,255,255,0.03)"; div.style.borderLeft = `4px solid ${config.color}`;
            div.innerHTML = `<span style="color:${config.color}; font-weight:bold; margin-right:10px;">0${index+1}</span> ${text}`;
            list.appendChild(div);
        });

        // é ä¼°è½é»
        let pSchool = "å¾…åŠ å¼·";
        for (let i = thresholds.length-1; i >= 0; i--) {
            if (total >= thresholds[i].score) { pSchool = thresholds[i].name; break; }
        }
        document.getElementById('predictSchool').innerText = pSchool;

        renderChart(s.grades);
    }

    // --- 6. é›·é”åœ– ---
    function renderChart(g) {
        const map = { "A++": 100, "A+": 92, "A": 85, "B++": 72, "B+": 62, "B": 50, "C": 20 };
        const ctx = document.getElementById('radarChart').getContext('2d');
        if(window.myRadar) window.myRadar.destroy();
        window.myRadar = new Chart(ctx, {
            type: 'radar',
            data: {
                labels: ['åœ‹æ–‡', 'è‹±æ–‡', 'æ•¸å­¸', 'è‡ªç„¶', 'ç¤¾æœƒ'],
                datasets: [{ 
                    data: [map[g.ch], map[g.en], map[g.ma], map[g.sc], map[g.so]], 
                    backgroundColor: 'rgba(34, 211, 238, 0.2)', 
                    borderColor: '#22d3ee', 
                    borderWidth: 2 
                }]
            },
            options: { 
                maintainAspectRatio: false, 
                scales: { r: { suggestedMin: 0, suggestedMax: 100, ticks: { display: false }, grid: { color: 'rgba(255,255,255,0.1)' }, angleLines: { color: 'rgba(255,255,255,0.1)' } } },
                plugins: { legend: { display: false } }
            }
        });
    }

    // å¯†ç¢¼å½ˆçª—
    function openPwdModal() { document.getElementById('overlay').style.display = 'block'; document.getElementById('pwdModal').style.display = 'block'; }
    function closePwdModal() { document.getElementById('overlay').style.display = 'none'; document.getElementById('pwdModal').style.display = 'none'; }
    function submitNewPwd() {
        const sid = document.getElementById('userSelect').value;
        const oldP = document.getElementById('oldPwd').value;
        const newP = document.getElementById('newPwd').value;
        const savedPass = localStorage.getItem('pwd_' + sid) || "308" + (sid < 10 ? '0'+sid : sid);
        if (oldP === savedPass && newP.length >= 4) { localStorage.setItem('pwd_' + sid, newP); alert("ä¿®æ”¹æˆåŠŸï¼"); closePwdModal(); }
        else alert("é©—è­‰éŒ¯èª¤æˆ–å¯†ç¢¼æ ¼å¼ä¸ç¬¦");
    }
</script>
</body>
</html>