<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 JAE | Growth Evolution</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --bg: #020617;
            --accent: #22d3ee;
            --gold: #f59e0b;
            --up: #4ade80;   /* é€²æ­¥è‰² */
            --down: #f87171; /* é€€æ­¥è‰² */
            --glass: rgba(15, 23, 42, 0.9);
            --border: rgba(34, 211, 238, 0.2);
        }

        body, html { margin: 0; padding: 0; min-height: 100vh; font-family: 'Segoe UI', 'Microsoft JhengHei', sans-serif; background-color: var(--bg); color: #fff; }

        /* --- ç™»å…¥ç•«é¢ --- */
        #loginWrapper {
            height: 100vh; width: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center;
            background: radial-gradient(circle at center, #1e293b 0%, #020617 100%);
            position: fixed; z-index: 1000; transition: 0.8s ease;
        }
        .game-title { font-size: clamp(2rem, 8vw, 4rem); font-weight: 900; letter-spacing: 5px; background: linear-gradient(to bottom, #fff, var(--accent)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin: 0; }
        .login-card { width: 85%; max-width: 400px; background: var(--glass); padding: 40px; border-radius: 30px; border: 1px solid var(--border); backdrop-filter: blur(15px); margin-top: 30px; }
        select, input { width: 100%; padding: 18px; margin: 10px 0; background: rgba(0,0,0,0.5); border: 1px solid #334155; border-radius: 12px; color: #fff; font-size: 1.1rem; box-sizing: border-box; }
        .btn-action { width: 100%; padding: 20px; border: none; border-radius: 12px; font-size: 1.3rem; font-weight: 800; cursor: pointer; transition: 0.3s; background: var(--accent); color: #020617; margin-top: 20px; }

        /* --- å ±è¡¨å…§å®¹ --- */
        #reportSection { display: none; max-width: 1200px; margin: 0 auto; padding: 40px 20px; }
        .header-box { background: var(--glass); border-radius: 30px; padding: 30px; display: flex; justify-content: space-between; align-items: center; border: 1px solid var(--border); margin-bottom: 25px; position: relative; }
        
        /* æˆé•·æ¨™ç±¤ */
        .growth-tag { position: absolute; top: -10px; right: 30px; padding: 5px 15px; border-radius: 20px; font-weight: 800; font-size: 0.9rem; }
        .growth-up { background: var(--up); color: #064e3b; }
        .growth-down { background: var(--down); color: #450a0a; }

        /* XP é€²åº¦æ¢ */
        .xp-header { display: flex; justify-content: space-between; font-size: 0.85rem; color: #94a3b8; margin-bottom: 8px; font-weight: bold; }
        .xp-bar-container { width: 300px; height: 12px; background: #1e293b; border-radius: 6px; overflow: hidden; border: 1px solid rgba(255,255,255,0.1); }
        .xp-bar-fill { height: 100%; background: linear-gradient(90deg, #06b6d4, #22d3ee); width: 0%; transition: 2.5s cubic-bezier(0.1, 1, 0.1, 1); }

        .stat-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-bottom: 25px; }
        .stat-card { background: var(--glass); padding: 20px; border-radius: 20px; text-align: center; border: 1px solid var(--border); }
        .stat-val { font-size: 2rem; font-weight: 900; color: var(--accent); display: block; }

        .main-layout { display: grid; grid-template-columns: 1.2fr 0.8fr; gap: 20px; }
        .card { background: var(--glass); border-radius: 25px; padding: 25px; border: 1px solid var(--border); }

        /* ä¿®æ”¹å¯†ç¢¼å½ˆçª— */
        #pwdModal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 90%; max-width: 350px; background: #0f172a; border: 2px solid var(--accent); padding: 30px; border-radius: 25px; z-index: 2000; }
        .overlay { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.8); z-index: 1500; }
    </style>
</head>
<body>

    <div id="loginWrapper">
        <h1 class="game-title">2026 JAE</h1>
        <div style="letter-spacing: 10px; color: #64748b; font-size: 0.8rem; margin-bottom: 30px;">9TH GRADE BATTLE REPORT</div>
        <div class="login-card">
            <select id="userSelect"><option value="">-- SELECT HERO --</option></select>
            <input type="password" id="userPass" placeholder="PASSCODE (308XX)">
            <button class="btn-action" onclick="handleLogin()">INITIALIZE</button>
        </div>
    </div>

    <div id="reportSection">
        <div class="header-box">
            <div id="growthTag" class="growth-tag"></div>
            <div style="display: flex; align-items: center;">
                <div id="rankOrb" style="width:90px; height:90px; border: 6px solid; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:3rem; font-weight:900; margin-right:25px;">?</div>
                <div>
                    <h2 id="displayName" style="margin:0; font-size: 2.5rem;">NAME</h2>
                    <div id="displayRank" style="color: var(--gold); font-weight: 800; font-size: 1.5rem;">RANK</div>
                    <div style="margin-top: 15px;">
                        <div class="xp-header">
                            <span id="nextLevelName">NEXT GOAL: ---</span>
                            <span id="xpRemaining">REMAINING: 0 XP</span>
                        </div>
                        <div class="xp-bar-container"><div id="xpFill" class="xp-bar-fill"></div></div>
                    </div>
                </div>
            </div>
            <div style="text-align: right;">
                <div style="font-size: 0.9rem; color: var(--accent); font-weight: bold;">TOTAL POWER (90+XP)</div>
                <div id="displayScore" style="font-size: 5.5rem; font-weight: 900; line-height:1;">0</div>
                <button onclick="openPwdModal()" style="background:none; border: 1px solid #475569; color:#475569; border-radius:5px; cursor:pointer; font-size:0.7rem; margin-top:10px;">ä¿®æ”¹å¯†ç¢¼</button>
            </div>
        </div>

        <div class="stat-grid">
            <div class="stat-card">ç­ç´šæ’å<span id="cRank" class="stat-val">-</span></div>
            <div class="stat-card">æ ¡å…§æ’å<span id="sRank" class="stat-val">-</span></div>
            <div class="stat-card">è€ƒå€æ’å<span id="dRank" class="stat-val">-</span></div>
            <div class="stat-card" style="border: 2px solid #f87171;">é ä¼°è½é»<span id="predictSchool" class="stat-val" style="font-size: 1.1rem; color:#fff;">-</span></div>
        </div>

        <div class="main-layout">
            <div class="card">
                <h3 style="margin-top:0; color:var(--accent);">ğŸ¯ æœ¬æ¬¡æˆ°å½¹æ”»ç•¥</h3>
                <div id="strategyList"></div>
            </div>
            <div class="card">
                <h3 style="margin-top:0; color:var(--accent);">ğŸ›¡ï¸ æˆ°åŠ›åˆ†å¸ƒ</h3>
                <div style="height: 300px;"><canvas id="radarChart"></canvas></div>
            </div>
        </div>
        
        <div onclick="location.reload()" style="text-align:center; color:#475569; margin:50px 0; cursor:pointer; letter-spacing:5px;">[ RETURN TO BASE ]</div>
    </div>

    <div id="overlay" class="overlay"></div>
    <div id="pwdModal">
        <h3 style="margin-top:0; color:var(--accent);">è®Šæ›´å®‰å…¨èªè­‰ç¢¼</h3>
        <input type="password" id="oldPwd" placeholder="ç›®å‰å¯†ç¢¼">
        <input type="password" id="newPwd" placeholder="æ–°å¯†ç¢¼">
        <button class="btn-action" onclick="submitNewPwd()">å„²å­˜è®Šæ›´</button>
        <button onclick="closePwdModal()" style="width:100%; background:none; border:none; color:#64748b; margin-top:15px; cursor:pointer;">å–æ¶ˆ</button>
    </div>

<script>
    // --- 1. å…¨ç­å®Œæ•´æ•¸æ“š (å§“åå·²é‚„åŸ) ---
    const studentDB = [
        { id: 1, name: "ç‹æ˜±å¡", rank: "æ¦®è€€æ˜Ÿè¾°", score: 30, prevScore: 25, cRank: 11, sRank: 176, dRank: 305, grades: {ch:"B+", en:"B", ma:"A", sc:"B+", so:"A++"}, s: ["æ’åå¤§å¹…é€²æ­¥ï¼ç¤¾æœƒ A++ å±•ç¾ç‹è€…å¯¦åŠ›ã€‚","ç›®æ¨™ï¼šè‹±æ–‡è‹¥è¡ä¸Š B+ï¼Œæˆ°åŠ›å°‡è·¨è¶Šä¸‹ä¸€éšã€‚"] },
        { id: 2, name: "å³æŸå‹³", rank: "ä¸å±ˆé’éŠ…", score: 26, prevScore: 27, cRank: 15, sRank: 260, dRank: 480, grades: {ch:"B", en:"B", ma:"B++", sc:"B++", so:"B++"}, s: ["è¡¨ç¾ç©©å®šï¼Œå„ç§‘æˆ°åŠ›åˆ†ä½ˆå¹³å‡ã€‚","ç›®æ¨™ï¼šå¼·åŒ–åœ‹æ–‡åŸºç¤ï¼Œçˆ­å–è¡åˆº B+ã€‚"] },
        { id: 3, name: "æä¸è«­", rank: "å¾…è¦ºé†’", score: 24, prevScore: 23, cRank: 21, sRank: 311, dRank: 586, grades: {ch:"B", en:"C", ma:"B++", sc:"B", so:"A"}, s: ["æ•¸å­¸èˆ‡ç¤¾æœƒè¡¨ç¾ä¸ä¿—ï¼Œç¤¾æœƒ A ç´šæ˜¯äº®é»ã€‚","è¦ºé†’ä»»å‹™ï¼šå„ªå…ˆæ‹¯æ•‘è‹±æ–‡ C ç´šï¼Œç¸½åˆ†å°‡ç¬é–“æš´æ¼²ã€‚"] },
        { id: 4, name: "æå† å®‰", rank: "å¾…è¦ºé†’", score: 24, prevScore: 18, cRank: 18, sRank: 302, dRank: 570, grades: {ch:"B+", en:"B", ma:"B", sc:"B", so:"B++"}, s: ["é¡¯è‘—é€²æ­¥ï¼å¾ç­æ’ 22 å‡è‡³ 18 åã€‚","å»ºè­°ï¼šä¿æŒç¤¾æœƒç§‘å„ªå‹¢ï¼ŒåŠ å¼·è‹±æ–‡ç·´ç¿’ã€‚"] },
        { id: 5, name: "æ²ˆæŸå½¥", rank: "ä¸å±ˆé’éŠ…", score: 26, prevScore: 29, cRank: 13, sRank: 241, dRank: 445, grades: {ch:"B++", en:"C", ma:"B+", sc:"B+", so:"B++"}, s: ["å››ç§‘çš†æœ‰ B+ ä»¥ä¸Šå¯¦åŠ›ï¼Œæˆ°åŠ›å¼·å‹ã€‚","ç›®æ¨™ï¼šæ”»å…‹è‹±æ–‡ C ç´šéšœç¤™ï¼Œä½ æ˜¯æ½›åœ¨çš„é»‘é¦¬ã€‚"] },
        { id: 6, name: "å¼µå¿—å®—", rank: "å¾…è¦ºé†’", score: 19, prevScore: 19, cRank: 25, sRank: 428, dRank: 924, grades: {ch:"C", en:"B", ma:"B", sc:"C", so:"B++"}, s: ["æˆ°åŠ›åˆ†ä½ˆå‘ˆç¾æ¥µç«¯ï¼Œç¤¾æœƒè¡¨ç¾å„ªç•°ã€‚","å»ºè­°ï¼šå„ªå…ˆåˆ†é…æ™‚é–“çµ¦åœ‹æ–‡èˆ‡è‡ªç„¶ã€‚"] },
        { id: 7, name: "æ¢ç¿ç¥", rank: "å¾…è¦ºé†’", score: 18, prevScore: 18, cRank: 26, sRank: 437, dRank: 966, grades: {ch:"B", en:"C", ma:"B", sc:"B", so:"B"}, s: ["è¡¨ç¾æŒå¹³ï¼Œå»ºè­°å¾æœ€æœ‰æŠŠæ¡çš„ä¸€ç§‘é–‹å§‹è¡åˆºã€‚"] },
        { id: 8, name: "é™³å† äºˆ", rank: "å¾…è¦ºé†’", score: 6, prevScore: 15, cRank: 30, sRank: 507, dRank: 1204, grades: {ch:"C", en:"C", ma:"C", sc:"C", so:"C"}, s: ["ç›®å‰è™•æ–¼ä½è°·ï¼Œä¸è¦ç°å¿ƒï¼Œæ‰¾å‡ºä¸€ç§‘å–œæ­¡çš„é–‹å§‹çªç ´ã€‚"] },
        { id: 9, name: "é™³å† å‘ˆ", rank: "æ¦®è€€æ˜Ÿè¾°", score: 33, prevScore: 34, cRank: 9, sRank: 128, dRank: 206, grades: {ch:"B++", en:"A", ma:"B++", sc:"B++", so:"A+"}, s: ["ç©©å±…å‰ 10 åï¼Œè‹±æ–‡ A ç´šæ˜¯ä½ çš„å …å¼·ç›¾ç‰Œã€‚","ç›®æ¨™ï¼šåœ‹æ–‡èˆ‡æ•¸å­¸è¡ä¸Š A ç´šï¼Œå³å¯è§£é–å½°ä¸­/å½°å¥³é–€æª»ã€‚"] },
        { id: 10, name: "é™³ä¿Šå®", rank: "æ¦®è€€æ˜Ÿè¾°", score: 29, prevScore: 26, cRank: 12, sRank: 185, dRank: 320, grades: {ch:"B++", en:"B++", ma:"A", sc:"B+", so:"B++"}, s: ["æ•¸å­¸è¡ä¸Š A ç´šï¼Œé€²æ­¥æœ‰ç›®å…±ç¹ã€‚","å»ºè­°ï¼šå°‡ç¤¾æœƒæˆ–è‹±æ–‡å…¶ä¸­ä¸€ç§‘æ¨å‘ A ç´šã€‚"] },
        { id: 11, name: "é»ƒå† å‡±", rank: "å¾…è¦ºé†’", score: 24, prevScore: 22, cRank: 17, sRank: 292, dRank: 541, grades: {ch:"B", en:"B", ma:"B", sc:"B", so:"B++"}, s: ["å…¨ç§‘ç„¡ C ç´šï¼Œåº•å­éå¸¸ç´®å¯¦ã€‚","å»ºè­°ï¼šå°ˆæ”»æ•¸å­¸æˆ–ç¤¾æœƒï¼Œå°‹æ±‚ç¬¬ä¸€å€‹ Aã€‚"] },
        { id: 12, name: "é»ƒå³»å”¯", rank: "ç’€ç’¨å‚³èªª", score: 37, prevScore: 30, cRank: 6, sRank: 62, dRank: 90, grades: {ch:"A", en:"A", ma:"B++", sc:"A", so:"A++"}, s: ["å¤§çˆ†ç™¼ï¼æ ¡æ’è¡å…¥å‰ 100ï¼Œä¸‰ç§‘ A ç´šä¸€ç§‘ A++ã€‚","ç›®æ¨™ï¼šæ•¸å­¸ B++ æ˜¯æœ€å¾Œä¸€é“é˜²ç·šï¼Œè¡ä¸Šå»å°±æ˜¯ç‹è€…ã€‚"] },
        { id: 13, name: "æ¥Šæ‰¿å®‡", rank: "ä¸å±ˆé’éŠ…", score: 22, prevScore: 21, cRank: 22, sRank: 354, dRank: 714, grades: {ch:"B", en:"B", ma:"B+", sc:"B", so:"B++"}, s: ["è¡¨ç¾ç©©å¥ï¼Œåœ‹ã€è‹±å…©ç§‘éœ€åŠ å¼·åŸºç¤é–±è®€ã€‚"] },
        { id: 14, name: "åŠ‰å®¶æ©", rank: "å¾…è¦ºé†’", score: 16, prevScore: 18, cRank: 27, sRank: 475, dRank: 1115, grades: {ch:"C", en:"B", ma:"C", sc:"B", so:"C"}, s: ["ç›®å‰ä¸‰ç§‘ C ç´šï¼Œå»ºè­°å…ˆå°‡åœ‹æ–‡æå‡è‡³ B ä»¥åˆ©ç†è§£é¡Œç›®ã€‚"] },
        { id: 15, name: "åŠ‰æŸæ‰¿", rank: "æ¦®è€€æ˜Ÿè¾°", score: 33, prevScore: 29, cRank: 8, sRank: 122, dRank: 195, grades: {ch:"B++", en:"A+", ma:"A", sc:"B++", so:"B++"}, s: ["é›™ A ç´šé¸æ‰‹ï¼Œè‹±æ–‡ A+ éå¸¸å‡ºè‰²ã€‚","å»ºè­°ï¼šåœ‹ç¤¾å…©ç§‘å¼·åŒ–ï¼Œç›®æ¨™é–å®šå“¡ä¸­ä»¥ä¸Šã€‚"] },
        { id: 16, name: "åŠ‰ç…¥é¨°", rank: "ç’€ç’¨å‚³èªª", score: 40, prevScore: 39, cRank: 2, sRank: 32, dRank: 39, grades: {ch:"A++", en:"B++", ma:"A+", sc:"A++", so:"A++"}, s: ["å…¨ç­å”¯äºŒçš„ A++ ä¸‰å† ç‹ï¼å½°ä¸­ç©©å®šéŒ„å–ã€‚","æˆ°è¡“ï¼šè‹±æ–‡æ˜¯é‚å‘å…¨å€å‰ 10 åçš„å”¯ä¸€é˜»ç¤™ã€‚"] },
        { id: 17, name: "æ´ªåƒèŠ¸", rank: "ä¸å±ˆé’éŠ…", score: 26, prevScore: 25, cRank: 14, sRank: 245, dRank: 450, grades: {ch:"B++", en:"B+", ma:"B", sc:"B+", so:"B++"}, s: ["æ’åå¾®å¹…ä¸Šå‡ï¼Œæˆ°åŠ›åˆ†å¸ƒå‡è¡¡ã€‚"] },
        { id: 18, name: "èƒ¡é‡‡å½¤", rank: "ä¸å±ˆé’éŠ…", score: 25, prevScore: 26, cRank: 16, sRank: 287, dRank: 528, grades: {ch:"B", en:"B+", ma:"B++", sc:"B+", so:"B"}, s: ["æ•¸å­¸èˆ‡è‹±æ–‡å…·æœ‰å„ªå‹¢ï¼Œéœ€è£œå¼·åœ‹ã€ç¤¾èƒŒèª¦ç§‘ç›®ã€‚"] },
        { id: 19, name: "å¼µèŠ¯ç¿Š", rank: "å¾…è¦ºé†’", score: 24, prevScore: 22, cRank: 19, sRank: 303, dRank: 572, grades: {ch:"B+", en:"B", ma:"B", sc:"B", so:"A"}, s: ["ç¤¾æœƒ A ç´šæ˜¯ä½ çš„å¼·é …ï¼Œå¸¶å‹•æ•´é«”æ’åã€‚"] },
        { id: 20, name: "å¼µæ…ˆè–°", rank: "ä¸å±ˆé’éŠ…", score: 21, prevScore: 26, cRank: 23, sRank: 359, dRank: 727, grades: {ch:"B+", en:"B+", ma:"B", sc:"C", so:"B"}, s: ["è‡ªç„¶ç§‘æ„å¤–æ‰å…¥ C ç´šï¼Œéœ€æ‰¾å›ç¯€å¥ã€‚"] },
        { id: 21, name: "è¨±èŠ¯è", rank: "ä¸å±ˆé’éŠ…", score: 20, prevScore: 25, cRank: 24, sRank: 419, dRank: 904, grades: {ch:"C", en:"C", ma:"B+", sc:"B", so:"B++"}, s: ["åœ‹è‹±é›™ C æ˜¯ç›®å‰æœ€å¤§é˜»åŠ›ï¼Œé‡é»è£œå¼·å–®å­—ã€‚"] },
        { id: 22, name: "é»ƒç­±è", rank: "ç’€ç’¨å‚³èªª", score: 39, prevScore: 38, cRank: 4, sRank: 41, dRank: 53, grades: {ch:"A++", en:"A", ma:"B+", sc:"A+", so:"A+"}, s: ["å…¨æ–¹ä½é«˜æˆ°åŠ›é¸æ‰‹ï¼Œå½°å¥³ç©©å®šéŒ„å–ã€‚"] },
        { id: 23, name: "é»ƒéƒæ¸", rank: "æ¦®è€€æ˜Ÿè¾°", score: 31, prevScore: 30, cRank: 10, sRank: 157, dRank: 263, grades: {ch:"B+", en:"B+", ma:"A+", sc:"B++", so:"A"}, s: ["æ•¸å­¸ A+ å±•ç¾æ¥µå¼·é‚è¼¯èƒ½åŠ›ï¼Œæ•´é«”æˆ°åŠ›ä¸Šå‡ã€‚"] },
        { id: 24, name: "è‘£è‹¥ç‘„", rank: "ç’€ç’¨å‚³èªª", score: 39, prevScore: 36, cRank: 5, sRank: 16, dRank: 57, grades: {ch:"A", en:"A+", ma:"A+", sc:"A+", so:"A"}, s: ["å…¨ç§‘çš† A ä»¥ä¸Šï¼æˆ°åŠ›é©šäººä¸”å‡è¡¡ï¼Œæ ¡æ’è¡¨ç¾å„ªç•°ã€‚"] },
        { id: 25, name: "é»ƒå®¶è¡", rank: "å¾…è¦ºé†’", score: 15, prevScore: 17, cRank: 28, sRank: 487, dRank: 1141, grades: {ch:"C", en:"C", ma:"B", sc:"C", so:"C"}, s: ["ç›®å‰æˆ°åŠ›è™•æ–¼å¾…è¦ºé†’ç‹€æ…‹ï¼Œåªè¦ä¸€ç§‘è¡ä¸Š B å³å¯è·¨è¶Šé–€æª»ã€‚"] },
        { id: 26, name: "è©¹ä½³ç’‡", rank: "æ¦®è€€æ˜Ÿè¾°", score: 29, prevScore: 28, cRank: 10, sRank: 248, dRank: 1198, grades: {ch:"B", en:"B+", ma:"B+", sc:"B+", so:"B+"}, s: ["å…¨ç§‘ B+ å±•ç¾å¼·å¤§ç©©å®šæ€§ï¼Œç›®æ¨™æ˜¯å°‹æ±‚ A ç´šçªç ´ã€‚"] },
        { id: 27, name: "å»–å¿ƒæ¸", rank: "å¾…è¦ºé†’", score: 19, prevScore: 19, cRank: 24, sRank: 215, dRank: 904, grades: {ch:"B", en:"B", ma:"C", sc:"C", so:"B"}, s: ["åœ‹ã€è‹±ã€ç¤¾åº•å­ä¸éŒ¯ï¼Œå„ªå…ˆè£œå¼·è‡ªç„¶åŸºç¤çŸ¥è­˜ã€‚"] },
        { id: 28, name: "åŠ‰èŠ®ç‘œ", rank: "ç’€ç’¨å‚³èªª", score: 40, prevScore: 37, cRank: 3, sRank: 13, dRank: 42, grades: {ch:"A++", en:"A+", ma:"A", sc:"A+", so:"A++"}, s: ["ä¸‰å† ç‹ï¼æ ¡æ’ç¬¬ 13 åï¼Œç›®æ¨™ç›´æŒ‡è€ƒå€å‰ 20ã€‚"] },
        { id: 29, name: "æ½˜å®¥éš", rank: "æ¦®è€€æ˜Ÿè¾°", score: 35, prevScore: 27, cRank: 7, sRank: 45, dRank: 133, grades: {ch:"A", en:"B++", ma:"A", sc:"B++", so:"A+"}, s: ["é€²æ­¥ç¥é€Ÿï¼å¾ç­æ’ 10 åè¡å…¥ç¬¬ 7 åã€‚"] },
        { id: 30, name: "è¬æ²›ç’‡", rank: "è‡³å°Šå‚³èªª", score: 42, prevScore: 40, cRank: 1, sRank: 6, dRank: 23, grades: {ch:"A+", en:"A+", ma:"A", sc:"A++", so:"A++"}, s: ["308 ç­æœ€å¼·æˆ°åŠ›ï¼æ ¡æ’å‰ 10ï¼Œå½°å¥³ç©©å®šéŒ„å–ã€‚"] }
    ];

    // --- 2. å­¸æ ¡é–€æª»è¨­å®š ---
    const thresholds = [
        { score: 104, name: "å„ªè³ªæŠ€è¡“é«˜ä¸­é–€æª»" },
        { score: 109, name: "å“¡å®¶å®¶æ”¿ / åŒ—å®¶å•†ç¶“" },
        { score: 112, name: "æºªæ¹–é«˜ä¸­ / å½°å•†å•†ç¶“" },
        { score: 116, name: "å½°å·¥é›»æ©Ÿ / å½°å•†æ‡‰å¤–" },
        { score: 120, name: "å½°ä¸­ / å½°å¥³" }
    ];

    // --- 3. åˆå§‹åŒ–é¸å–® (é€™éƒ¨åˆ†è§£æ±ºé¸å–®è·‘ä¸å‡ºä¾†çš„å•é¡Œ) ---
    window.onload = function() {
        const selectEl = document.getElementById('userSelect');
        if (selectEl) {
            selectEl.innerHTML = '<option value="">-- è«‹é¸æ“‡è‹±é›„ --</option>';
            studentDB.forEach(s => {
                const opt = document.createElement('option');
                opt.value = s.id;
                opt.textContent = `${s.id < 10 ? '0'+s.id : s.id} - ${s.name}`;
                selectEl.appendChild(opt);
            });
        }
    };

    // --- 4. ç™»å…¥é‚è¼¯ ---
    function handleLogin() {
        const sid = document.getElementById('userSelect').value;
        const inputPass = document.getElementById('userPass').value;
        const savedPass = localStorage.getItem('pwd_' + sid) || "308" + (sid < 10 ? '0'+sid : sid);
        
        if(!sid) { alert("è«‹é¸æ“‡å­¸ç”Ÿå§“å"); return; }
        if(inputPass === savedPass) {
            document.getElementById('loginWrapper').style.opacity = "0";
            setTimeout(() => { 
                document.getElementById('loginWrapper').style.display = "none"; 
                showReport(sid); 
            }, 600);
        } else {
            alert("å¯†ç¢¼éŒ¯èª¤ï¼Œè«‹é‡æ–°è¼¸å…¥");
        }
    }

    // --- 5. é¡¯ç¤ºå ±è¡¨å…§å®¹ ---
    function showReport(id) {
        const s = studentDB.find(item => item.id == id);
        const total = 90 + s.score;
        document.getElementById('reportSection').style.display = "block";
        document.getElementById('displayName').innerText = s.name;
        document.getElementById('displayScore').innerText = total;
        document.getElementById('displayRank').innerText = s.rank;
        document.getElementById('cRank').innerText = s.cRank;
        document.getElementById('sRank').innerText = s.sRank;
        document.getElementById('dRank').innerText = s.dRank;

        // æˆé•·æ¨™ç±¤
        const growthTag = document.getElementById('growthTag');
        const diff = s.score - s.prevScore;
        if (diff > 0) {
            growthTag.innerText = `â–² èˆ‡ä¸Šæ¬¡ç›¸æ¯”é€²æ­¥ ${diff} åˆ†`;
            growthTag.className = "growth-tag growth-up";
        } else if (diff < 0) {
            growthTag.innerText = `â–¼ èˆ‡ä¸Šæ¬¡ç›¸æ¯”é€€æ­¥ ${Math.abs(diff)} åˆ†`;
            growthTag.className = "growth-tag growth-down";
        } else {
            growthTag.innerText = "â— æˆ°åŠ›æŒå¹³";
            growthTag.style.background = "#475569";
        }

        // XP é€²åº¦æ¢
        const nextGoal = thresholds.find(t => t.score > total) || thresholds[thresholds.length-1];
        const prevGoalScore = (thresholds.slice().reverse().find(t => t.score <= total)?.score || 90);
        const progress = ((total - prevGoalScore) / (nextGoal.score - prevGoalScore)) * 100;
        document.getElementById('nextLevelName').innerText = `ä¸‹ä¸€ç›®æ¨™ï¼š${nextGoal.name}`;
        document.getElementById('xpRemaining').innerText = nextGoal.score > total ? `å°šéœ€ï¼š${nextGoal.score - total} åˆ†` : "é ‚å°–æˆ°åŠ›";
        document.getElementById('xpFill').style.width = Math.max(10, progress) + "%";

        // é›·é”åœ–
        renderChart(s.grades);
        
        // è½é»é æ¸¬
        let pSchool = "å¾…åŠ å¼·";
        for (let i = thresholds.length-1; i >= 0; i--) {
            if (total >= thresholds[i].score) { pSchool = thresholds[i].name; break; }
        }
        document.getElementById('predictSchool').innerText = pSchool;

        // æˆ°ç•¥æ¸…å–®
        const list = document.getElementById('strategyList');
        list.innerHTML = "";
        s.s.forEach(text => {
            const div = document.createElement('div');
            div.style.padding = "15px"; div.style.marginBottom = "10px";
            div.style.background = "rgba(255,255,255,0.03)"; div.style.borderLeft = "4px solid var(--accent)";
            div.innerText = text; list.appendChild(div);
        });
    }

    function renderChart(g) {
        const map = { "A++": 100, "A+": 92, "A": 85, "B++": 72, "B+": 62, "B": 50, "C": 20 };
        const ctx = document.getElementById('radarChart').getContext('2d');
        // å…ˆéŠ·æ¯€èˆŠåœ–è¡¨é¿å…é‡ç–Š
        if(window.myRadar) window.myRadar.destroy();
        window.myRadar = new Chart(ctx, {
            type: 'radar',
            data: {
                labels: ['åœ‹æ–‡', 'è‹±æ–‡', 'æ•¸å­¸', 'è‡ªç„¶', 'ç¤¾æœƒ'],
                datasets: [{ 
                    data: [map[g.ch], map[g.en], map[g.ma], map[g.sc], map[g.so]], 
                    backgroundColor: 'rgba(34, 211, 238, 0.2)', 
                    borderColor: '#22d3ee', 
                    borderWidth: 3 
                }]
            },
            options: { 
                maintainAspectRatio: false, 
                scales: { r: { suggestedMin: 0, suggestedMax: 100, ticks: { display: false }, grid: { color: 'rgba(255,255,255,0.1)' } } },
                plugins: { legend: { display: false } }
            }
        });
    }

    // å¯†ç¢¼ä¿®æ”¹é‚è¼¯
    function openPwdModal() { document.getElementById('overlay').style.display = 'block'; document.getElementById('pwdModal').style.display = 'block'; }
    function closePwdModal() { document.getElementById('overlay').style.display = 'none'; document.getElementById('pwdModal').style.display = 'none'; }
    function submitNewPwd() {
        const sid = document.getElementById('userSelect').value;
        const oldP = document.getElementById('oldPwd').value;
        const newP = document.getElementById('newPwd').value;
        const savedPass = localStorage.getItem('pwd_' + sid) || "308" + (sid < 10 ? '0'+sid : sid);
        if (oldP === savedPass && newP.length >= 4) { localStorage.setItem('pwd_' + sid, newP); alert("ä¿®æ”¹æˆåŠŸï¼"); closePwdModal(); }
        else alert("é©—è­‰éŒ¯èª¤æˆ–æ–°å¯†ç¢¼å¤ªçŸ­");
    }

</script>
</body>
</html>